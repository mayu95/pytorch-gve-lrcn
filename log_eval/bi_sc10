Arguments:
data_path                     ./data
checkpoint_path               ./checkpoints
log_step                      10
num_workers                   4
disable_cuda                  False
cuda_device                   0
torch_seed                    11829973587394806704
model                         gve
dataset                       iu
pretrained_model              vgg16
layers_to_truncate            1
sc_ckpt                       ./data/iu/sentence_classifier_ckpt.pth
weights_ckpt                  None
loss_lambda                   0.2
embedding_size                1000
hidden_size                   1000
num_epochs                    30
batch_size                    128
learning_rate                 0.001
train                         True
eval_ckpt                     None

Preparing Data ...
loading annotations into memory...
Done (t=0.04s)
creating index...
index created!
loading annotations into memory...
Done (t=0.00s)
creating index...
index created!

Loading Model ...
embed_size: 1000
GVE(
  (vision_model): PretrainedModel(
    (pretrained_model): VGG(
      (features): Sequential(
        (0): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (1): ReLU(inplace)
        (2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (3): ReLU(inplace)
        (4): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
        (5): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (6): ReLU(inplace)
        (7): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (8): ReLU(inplace)
        (9): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
        (10): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (11): ReLU(inplace)
        (12): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (13): ReLU(inplace)
        (14): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (15): ReLU(inplace)
        (16): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
        (17): Conv2d(256, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (18): ReLU(inplace)
        (19): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (20): ReLU(inplace)
        (21): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (22): ReLU(inplace)
        (23): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
        (24): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (25): ReLU(inplace)
        (26): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (27): ReLU(inplace)
        (28): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (29): ReLU(inplace)
        (30): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
      )
      (avgpool): AdaptiveAvgPool2d(output_size=(7, 7))
      (classifier): Sequential(
        (0): Linear(in_features=25088, out_features=4096, bias=True)
        (1): ReLU(inplace)
        (2): Dropout(p=0.5)
        (3): Linear(in_features=4096, out_features=4096, bias=True)
        (4): ReLU(inplace)
        (5): Dropout(p=0.5)
      )
    )
  )
  (word_embed): Embedding(978, 1000, padding_idx=0)
  (linear1): Linear(in_features=4096, out_features=1000, bias=True)
  (lstm1): LSTM(1000, 1000, batch_first=True)
  (lstm2): LSTM(2017, 1000, batch_first=True)
  (linear2): Linear(in_features=1000, out_features=978, bias=True)
  (sentence_classifier): SentenceClassifier(
    (word_embed): Embedding(978, 1000, padding_idx=0)
    (lstm): LSTM(1000, 2000, batch_first=True, bidirectional=True)
    (linear): Linear(in_features=4000, out_features=17, bias=True)
  )
) 

Training ...
Epoch [0/30], Step [0/23], Loss: 8.8339, Perplexity: 6862.7941
Epoch [0/30], Step [10/23], Loss: 5.1175, Perplexity: 166.9231
Epoch [0/30], Step [20/23], Loss: 5.6357, Perplexity: 280.2554
Epoch [0/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 8495, 'reflen': 10832, 'guess': [8495, 8130, 7765, 7400], 'correct': [2986, 865, 233, 3]}
ratio: 0.7842503692761462
Bleu_1: 0.267
Bleu_2: 0.147
Bleu_3: 0.079
Bleu_4: 0.020
computing METEOR score...
METEOR: 0.105
computing Rouge score...
ROUGE_L: 0.246
computing CIDEr score...
CIDEr: 0.081
dict_items([('Bleu_1', 0.26696277286548975), ('Bleu_2', 0.1468758102395374), ('Bleu_3', 0.07892472888473324), ('Bleu_4', 0.019724830453400042), ('METEOR', 0.1046628018411168), ('ROUGE_L', 0.246042922220357), ('CIDEr', 0.0805299967718122)])
Epoch [1/30], Step [0/23], Loss: 4.8743, Perplexity: 130.8795
Epoch [1/30], Step [10/23], Loss: 4.5591, Perplexity: 95.4945
Epoch [1/30], Step [20/23], Loss: 3.7215, Perplexity: 41.3243
Epoch [1/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 4647, 'reflen': 10832, 'guess': [4647, 4282, 3917, 3552], 'correct': [2968, 1354, 710, 280]}
ratio: 0.4290066469718954
Bleu_1: 0.169
Bleu_2: 0.119
Bleu_3: 0.088
Bleu_4: 0.061
computing METEOR score...
METEOR: 0.130
computing Rouge score...
ROUGE_L: 0.323
computing CIDEr score...
CIDEr: 0.134
dict_items([('Bleu_1', 0.16875627924849235), ('Bleu_2', 0.11874089828804998), ('Bleu_3', 0.08773200436482216), ('Bleu_4', 0.06123954940801873), ('METEOR', 0.12969568134764173), ('ROUGE_L', 0.32283732373793755), ('CIDEr', 0.13369244264672375)])
Epoch [2/30], Step [0/23], Loss: 3.9328, Perplexity: 51.0510
Epoch [2/30], Step [10/23], Loss: 3.1098, Perplexity: 22.4157
Epoch [2/30], Step [20/23], Loss: 2.5121, Perplexity: 12.3304
Epoch [2/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 9125, 'reflen': 10832, 'guess': [9125, 8760, 8395, 8030], 'correct': [4859, 2067, 1115, 610]}
ratio: 0.8424113737074554
Bleu_1: 0.442
Bleu_2: 0.294
Bleu_3: 0.212
Bleu_4: 0.156
computing METEOR score...
METEOR: 0.201
computing Rouge score...
ROUGE_L: 0.361
computing CIDEr score...
CIDEr: 0.339
dict_items([('Bleu_1', 0.441642857956864), ('Bleu_2', 0.2939898819717814), ('Bleu_3', 0.21194607261608933), ('Bleu_4', 0.1564991196790108), ('METEOR', 0.20052818952748877), ('ROUGE_L', 0.360685861860929), ('CIDEr', 0.33914876500776736)])
Epoch [3/30], Step [0/23], Loss: 2.2438, Perplexity: 9.4291
Epoch [3/30], Step [10/23], Loss: 2.3331, Perplexity: 10.3099
Epoch [3/30], Step [20/23], Loss: 2.6071, Perplexity: 13.5600
Epoch [3/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 6570, 'reflen': 10832, 'guess': [6570, 6205, 5840, 5475], 'correct': [3404, 1473, 825, 395]}
ratio: 0.6065361890693679
Bleu_1: 0.271
Bleu_2: 0.183
Bleu_3: 0.135
Bleu_4: 0.098
computing METEOR score...
METEOR: 0.146
computing Rouge score...
ROUGE_L: 0.315
computing CIDEr score...
CIDEr: 0.312
dict_items([('Bleu_1', 0.27082867264961813), ('Bleu_2', 0.18332134325895943), ('Bleu_3', 0.13538769908970605), ('Bleu_4', 0.09835699766471756), ('METEOR', 0.14598450127278367), ('ROUGE_L', 0.3150373229451846), ('CIDEr', 0.31206104735788764)])
Epoch [4/30], Step [0/23], Loss: 2.1693, Perplexity: 8.7520
Epoch [4/30], Step [10/23], Loss: 2.2182, Perplexity: 9.1904
Epoch [4/30], Step [20/23], Loss: 1.7828, Perplexity: 5.9467
Epoch [4/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 12410, 'reflen': 10832, 'guess': [12410, 12045, 11680, 11315], 'correct': [5093, 2370, 1389, 887]}
ratio: 1.1456794682421394
Bleu_1: 0.410
Bleu_2: 0.284
Bleu_3: 0.213
Bleu_4: 0.166
computing METEOR score...
METEOR: 0.204
computing Rouge score...
ROUGE_L: 0.345
computing CIDEr score...
CIDEr: 0.706
dict_items([('Bleu_1', 0.4103948428686212), ('Bleu_2', 0.2841657409598994), ('Bleu_3', 0.21255318307840698), ('Bleu_4', 0.1656410501443222), ('METEOR', 0.2041329546838664), ('ROUGE_L', 0.3450181275917098), ('CIDEr', 0.705841836402278)])
Epoch [5/30], Step [0/23], Loss: 1.6910, Perplexity: 5.4251
Epoch [5/30], Step [10/23], Loss: 1.4971, Perplexity: 4.4686
Epoch [5/30], Step [20/23], Loss: 1.3140, Perplexity: 3.7212
Epoch [5/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 12410, 'reflen': 10832, 'guess': [12410, 12045, 11680, 11315], 'correct': [5093, 2370, 1389, 887]}
ratio: 1.1456794682421394
Bleu_1: 0.410
Bleu_2: 0.284
Bleu_3: 0.213
Bleu_4: 0.166
computing METEOR score...
METEOR: 0.204
computing Rouge score...
ROUGE_L: 0.345
computing CIDEr score...
CIDEr: 0.706
dict_items([('Bleu_1', 0.4103948428686212), ('Bleu_2', 0.2841657409598994), ('Bleu_3', 0.21255318307840698), ('Bleu_4', 0.1656410501443222), ('METEOR', 0.2041329546838664), ('ROUGE_L', 0.3450181275917098), ('CIDEr', 0.705841836402278)])
Epoch [6/30], Step [0/23], Loss: 1.4083, Perplexity: 4.0891
Epoch [6/30], Step [10/23], Loss: 1.2621, Perplexity: 3.5329
Epoch [6/30], Step [20/23], Loss: 1.2804, Perplexity: 3.5981
Epoch [6/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 12410, 'reflen': 10832, 'guess': [12410, 12045, 11680, 11315], 'correct': [5093, 2370, 1389, 887]}
ratio: 1.1456794682421394
Bleu_1: 0.410
Bleu_2: 0.284
Bleu_3: 0.213
Bleu_4: 0.166
computing METEOR score...
METEOR: 0.204
computing Rouge score...
ROUGE_L: 0.345
computing CIDEr score...
CIDEr: 0.706
dict_items([('Bleu_1', 0.4103948428686212), ('Bleu_2', 0.2841657409598994), ('Bleu_3', 0.21255318307840698), ('Bleu_4', 0.1656410501443222), ('METEOR', 0.2041329546838664), ('ROUGE_L', 0.3450181275917098), ('CIDEr', 0.705841836402278)])
Epoch [7/30], Step [0/23], Loss: 1.3297, Perplexity: 3.7801
Epoch [7/30], Step [10/23], Loss: 1.2692, Perplexity: 3.5579
Epoch [7/30], Step [20/23], Loss: 1.5715, Perplexity: 4.8140
Epoch [7/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 11850, 'reflen': 10832, 'guess': [11850, 11485, 11120, 10755], 'correct': [4996, 2353, 1415, 915]}
ratio: 1.0939807976365312
Bleu_1: 0.422
Bleu_2: 0.294
Bleu_3: 0.222
Bleu_4: 0.175
computing METEOR score...
METEOR: 0.202
computing Rouge score...
ROUGE_L: 0.348
computing CIDEr score...
CIDEr: 0.702
dict_items([('Bleu_1', 0.4216033755273906), ('Bleu_2', 0.29389859066481405), ('Bleu_3', 0.22233895145361837), ('Bleu_4', 0.17486960729307782), ('METEOR', 0.20201136238734213), ('ROUGE_L', 0.34794429836759394), ('CIDEr', 0.7018814702673832)])
Epoch [8/30], Step [0/23], Loss: 1.2266, Perplexity: 3.4097
Epoch [8/30], Step [10/23], Loss: 1.7515, Perplexity: 5.7635
Epoch [8/30], Step [20/23], Loss: 1.2787, Perplexity: 3.5920
Epoch [8/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 8395, 'reflen': 10832, 'guess': [8395, 8030, 7665, 7300], 'correct': [3499, 1698, 889, 309]}
ratio: 0.775018463810859
Bleu_1: 0.312
Bleu_2: 0.222
Bleu_3: 0.162
Bleu_4: 0.108
computing METEOR score...
METEOR: 0.168
computing Rouge score...
ROUGE_L: 0.309
computing CIDEr score...
CIDEr: 0.204
dict_items([('Bleu_1', 0.31178204234409956), ('Bleu_2', 0.22207544800083667), ('Bleu_3', 0.16234522412018737), ('Bleu_4', 0.10788734520786027), ('METEOR', 0.1676601541556232), ('ROUGE_L', 0.3094033410948117), ('CIDEr', 0.20411023002614734)])
Epoch [9/30], Step [0/23], Loss: 1.2922, Perplexity: 3.6407
Epoch [9/30], Step [10/23], Loss: 1.0339, Perplexity: 2.8120
Epoch [9/30], Step [20/23], Loss: 1.1396, Perplexity: 3.1254
Epoch [9/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 8395, 'reflen': 10832, 'guess': [8395, 8030, 7665, 7300], 'correct': [3487, 1705, 935, 353]}
ratio: 0.775018463810859
Bleu_1: 0.311
Bleu_2: 0.222
Bleu_3: 0.165
Bleu_4: 0.113
computing METEOR score...
METEOR: 0.166
computing Rouge score...
ROUGE_L: 0.309
computing CIDEr score...
CIDEr: 0.197
dict_items([('Bleu_1', 0.31071276983534585), ('Bleu_2', 0.22215080844735385), ('Bleu_3', 0.1651357238518302), ('Bleu_4', 0.11297327039236615), ('METEOR', 0.16566875582271692), ('ROUGE_L', 0.30862300042170987), ('CIDEr', 0.1966240481934259)])
Epoch [10/30], Step [0/23], Loss: 1.0654, Perplexity: 2.9020
Epoch [10/30], Step [10/23], Loss: 1.1251, Perplexity: 3.0807
Epoch [10/30], Step [20/23], Loss: 1.1257, Perplexity: 3.0825
Epoch [10/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 8395, 'reflen': 10832, 'guess': [8395, 8030, 7665, 7300], 'correct': [3443, 1667, 897, 317]}
ratio: 0.775018463810859
Bleu_1: 0.307
Bleu_2: 0.218
Bleu_3: 0.161
Bleu_4: 0.108
computing METEOR score...
METEOR: 0.164
computing Rouge score...
ROUGE_L: 0.305
computing CIDEr score...
CIDEr: 0.209
dict_items([('Bleu_1', 0.30679210396991563), ('Bleu_2', 0.21827100292417856), ('Bleu_3', 0.1609657246687596), ('Bleu_4', 0.10788625583100003), ('METEOR', 0.16412448881315111), ('ROUGE_L', 0.3053059184360375), ('CIDEr', 0.20948470399191435)])
Epoch [11/30], Step [0/23], Loss: 0.9936, Perplexity: 2.7009
Epoch [11/30], Step [10/23], Loss: 1.1474, Perplexity: 3.1501
Epoch [11/30], Step [20/23], Loss: 1.5310, Perplexity: 4.6229
Epoch [11/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 10526, 'reflen': 10832, 'guess': [10526, 10161, 9796, 9431], 'correct': [2790, 1287, 653, 227]}
ratio: 0.9717503692761289
Bleu_1: 0.257
Bleu_2: 0.178
Bleu_3: 0.127
Bleu_4: 0.083
computing METEOR score...
METEOR: 0.121
computing Rouge score...
ROUGE_L: 0.230
computing CIDEr score...
CIDEr: 0.055
dict_items([('Bleu_1', 0.25746341073063117), ('Bleu_2', 0.17797792831293827), ('Bleu_3', 0.1270546195154754), ('Bleu_4', 0.08321536898491089), ('METEOR', 0.12099860485100809), ('ROUGE_L', 0.23013719167498975), ('CIDEr', 0.05511241938563178)])
Epoch [12/30], Step [0/23], Loss: 1.4145, Perplexity: 4.1144
Epoch [12/30], Step [10/23], Loss: 1.1035, Perplexity: 3.0147
Epoch [12/30], Step [20/23], Loss: 1.3675, Perplexity: 3.9257
Epoch [12/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 6570, 'reflen': 10832, 'guess': [6570, 6205, 5840, 5475], 'correct': [1836, 600, 243, 39]}
ratio: 0.6065361890693679
Bleu_1: 0.146
Bleu_2: 0.086
Bleu_3: 0.054
Bleu_4: 0.028
computing METEOR score...
METEOR: 0.075
computing Rouge score...
ROUGE_L: 0.187
computing CIDEr score...
CIDEr: 0.030
dict_items([('Bleu_1', 0.14607562954897146), ('Bleu_2', 0.0859268409111593), ('Bleu_3', 0.0543551283379936), ('Bleu_4', 0.02780789595579469), ('METEOR', 0.07503813362631291), ('ROUGE_L', 0.18650160320118933), ('CIDEr', 0.02971848909470335)])
Epoch [13/30], Step [0/23], Loss: 1.0252, Perplexity: 2.7876
Epoch [13/30], Step [10/23], Loss: 1.0398, Perplexity: 2.8288
Epoch [13/30], Step [20/23], Loss: 1.0036, Perplexity: 2.7281
Epoch [13/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 5475, 'reflen': 10832, 'guess': [5475, 5110, 4745, 4380], 'correct': [1914, 641, 252, 45]}
ratio: 0.5054468242244733
Bleu_1: 0.131
Bleu_2: 0.079
Bleu_3: 0.050
Bleu_4: 0.026
computing METEOR score...
METEOR: 0.083
computing Rouge score...
ROUGE_L: 0.200
computing CIDEr score...
CIDEr: 0.058
dict_items([('Bleu_1', 0.1314085020751393), ('Bleu_2', 0.07871601948048114), ('Bleu_3', 0.049825547088375874), ('Bleu_4', 0.026289968849919465), ('METEOR', 0.08276822600285869), ('ROUGE_L', 0.20013343295229583), ('CIDEr', 0.05754390426593267)])
Epoch [14/30], Step [0/23], Loss: 1.1513, Perplexity: 3.1623
Epoch [14/30], Step [10/23], Loss: 0.9127, Perplexity: 2.4910
Epoch [14/30], Step [20/23], Loss: 0.8697, Perplexity: 2.3862
Epoch [14/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 6205, 'reflen': 10832, 'guess': [6205, 5840, 5475, 5110], 'correct': [1765, 656, 254, 40]}
ratio: 0.5728397341210697
Bleu_1: 0.135
Bleu_2: 0.085
Bleu_3: 0.054
Bleu_4: 0.028
computing METEOR score...
METEOR: 0.080
computing Rouge score...
ROUGE_L: 0.182
computing CIDEr score...
CIDEr: 0.052
dict_items([('Bleu_1', 0.13494423110942722), ('Bleu_2', 0.08480048913573883), ('Bleu_3', 0.05409194141387498), ('Bleu_4', 0.02768834829392213), ('METEOR', 0.08019235315728526), ('ROUGE_L', 0.181556463209391), ('CIDEr', 0.051774261206288204)])
Epoch [15/30], Step [0/23], Loss: 0.8183, Perplexity: 2.2666
Epoch [15/30], Step [10/23], Loss: 0.8028, Perplexity: 2.2317
Epoch [15/30], Step [20/23], Loss: 0.9374, Perplexity: 2.5534
Epoch [15/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 6935, 'reflen': 10832, 'guess': [6935, 6570, 6205, 5840], 'correct': [1765, 656, 254, 40]}
ratio: 0.6402326440176661
Bleu_1: 0.145
Bleu_2: 0.091
Bleu_3: 0.058
Bleu_4: 0.029
computing METEOR score...
METEOR: 0.079
computing Rouge score...
ROUGE_L: 0.175
computing CIDEr score...
CIDEr: 0.041
dict_items([('Bleu_1', 0.14509557856280048), ('Bleu_2', 0.09088124990132897), ('Bleu_3', 0.05776509375488072), ('Bleu_4', 0.029454379731865092), ('METEOR', 0.07911744544017427), ('ROUGE_L', 0.1752381955035874), ('CIDEr', 0.040915932694795945)])
Epoch [16/30], Step [0/23], Loss: 0.8197, Perplexity: 2.2698
Epoch [16/30], Step [10/23], Loss: 0.9231, Perplexity: 2.5171
Epoch [16/30], Step [20/23], Loss: 0.7338, Perplexity: 2.0830
Epoch [16/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 8760, 'reflen': 10832, 'guess': [8760, 8395, 8030, 7665], 'correct': [1496, 597, 250, 44]}
ratio: 0.8087149187591572
Bleu_1: 0.135
Bleu_2: 0.087
Bleu_3: 0.057
Bleu_4: 0.030
computing METEOR score...
METEOR: 0.072
computing Rouge score...
ROUGE_L: 0.137
computing CIDEr score...
CIDEr: 0.028
dict_items([('Bleu_1', 0.1348043641859186), ('Bleu_2', 0.08698953793989185), ('Bleu_3', 0.05707925886725201), ('Bleu_4', 0.03029793221997025), ('METEOR', 0.07207322949369557), ('ROUGE_L', 0.13736690683168815), ('CIDEr', 0.028053177508704785)])
Epoch [17/30], Step [0/23], Loss: 0.7738, Perplexity: 2.1679
Epoch [17/30], Step [10/23], Loss: 0.8937, Perplexity: 2.4441
Epoch [17/30], Step [20/23], Loss: 0.8418, Perplexity: 2.3205
Epoch [17/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 5475, 'reflen': 10832, 'guess': [5475, 5110, 4745, 4380], 'correct': [1643, 643, 282, 75]}
ratio: 0.5054468242244733
Bleu_1: 0.113
Bleu_2: 0.073
Bleu_3: 0.049
Bleu_4: 0.030
computing METEOR score...
METEOR: 0.084
computing Rouge score...
ROUGE_L: 0.174
computing CIDEr score...
CIDEr: 0.040
dict_items([('Bleu_1', 0.11280259608644402), ('Bleu_2', 0.0730444816021342), ('Bleu_3', 0.049213523083863855), ('Bleu_4', 0.0295955587845539), ('METEOR', 0.08361851541094768), ('ROUGE_L', 0.17383270789023741), ('CIDEr', 0.03971363110655258)])
Epoch [18/30], Step [0/23], Loss: 0.8290, Perplexity: 2.2909
Epoch [18/30], Step [10/23], Loss: 0.7301, Perplexity: 2.0753
Epoch [18/30], Step [20/23], Loss: 0.7034, Perplexity: 2.0207
Epoch [18/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 5475, 'reflen': 10832, 'guess': [5475, 5110, 4745, 4380], 'correct': [1643, 643, 282, 75]}
ratio: 0.5054468242244733
Bleu_1: 0.113
Bleu_2: 0.073
Bleu_3: 0.049
Bleu_4: 0.030
computing METEOR score...
METEOR: 0.084
computing Rouge score...
ROUGE_L: 0.174
computing CIDEr score...
CIDEr: 0.040
dict_items([('Bleu_1', 0.11280259608644402), ('Bleu_2', 0.0730444816021342), ('Bleu_3', 0.049213523083863855), ('Bleu_4', 0.0295955587845539), ('METEOR', 0.08361851541094768), ('ROUGE_L', 0.17383270789023741), ('CIDEr', 0.03971363110655258)])
Epoch [19/30], Step [0/23], Loss: 0.7487, Perplexity: 2.1142
Epoch [19/30], Step [10/23], Loss: 0.6785, Perplexity: 1.9709
Epoch [19/30], Step [20/23], Loss: 0.7298, Perplexity: 2.0746
Epoch [19/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 7546, 'reflen': 10832, 'guess': [7546, 7181, 6816, 6451], 'correct': [2561, 995, 440, 158]}
ratio: 0.6966395864105708
Bleu_1: 0.220
Bleu_2: 0.140
Bleu_3: 0.094
Bleu_4: 0.060
computing METEOR score...
METEOR: 0.113
computing Rouge score...
ROUGE_L: 0.209
computing CIDEr score...
CIDEr: 0.093
dict_items([('Bleu_1', 0.2195704127236817), ('Bleu_2', 0.14029639329087776), ('Bleu_3', 0.09367687245619212), ('Bleu_4', 0.06007614522530843), ('METEOR', 0.11291153026486306), ('ROUGE_L', 0.20936686071520164), ('CIDEr', 0.09275233618059651)])
Epoch [20/30], Step [0/23], Loss: 0.7079, Perplexity: 2.0298
Epoch [20/30], Step [10/23], Loss: 0.6413, Perplexity: 1.8989
Epoch [20/30], Step [20/23], Loss: 0.6595, Perplexity: 1.9338
Epoch [20/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 7546, 'reflen': 10832, 'guess': [7546, 7181, 6816, 6451], 'correct': [2525, 963, 408, 127]}
ratio: 0.6966395864105708
Bleu_1: 0.216
Bleu_2: 0.137
Bleu_3: 0.090
Bleu_4: 0.055
computing METEOR score...
METEOR: 0.112
computing Rouge score...
ROUGE_L: 0.207
computing CIDEr score...
CIDEr: 0.105
dict_items([('Bleu_1', 0.21648390946009224), ('Bleu_2', 0.13704841324190017), ('Bleu_3', 0.08993316582774023), ('Bleu_4', 0.05517017241667775), ('METEOR', 0.11184778186560355), ('ROUGE_L', 0.20664125270891495), ('CIDEr', 0.10474781793273595)])
Epoch [21/30], Step [0/23], Loss: 0.7043, Perplexity: 2.0224
Epoch [21/30], Step [10/23], Loss: 0.6315, Perplexity: 1.8804
Epoch [21/30], Step [20/23], Loss: 0.6429, Perplexity: 1.9019
Epoch [21/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 7546, 'reflen': 10832, 'guess': [7546, 7181, 6816, 6451], 'correct': [2525, 963, 408, 127]}
ratio: 0.6966395864105708
Bleu_1: 0.216
Bleu_2: 0.137
Bleu_3: 0.090
Bleu_4: 0.055
computing METEOR score...
METEOR: 0.112
computing Rouge score...
ROUGE_L: 0.207
computing CIDEr score...
CIDEr: 0.105
dict_items([('Bleu_1', 0.21648390946009224), ('Bleu_2', 0.13704841324190017), ('Bleu_3', 0.08993316582774023), ('Bleu_4', 0.05517017241667775), ('METEOR', 0.11184778186560355), ('ROUGE_L', 0.20664125270891495), ('CIDEr', 0.10474781793273595)])
Epoch [22/30], Step [0/23], Loss: 0.5646, Perplexity: 1.7588
Epoch [22/30], Step [10/23], Loss: 0.6555, Perplexity: 1.9260
Epoch [22/30], Step [20/23], Loss: 0.6182, Perplexity: 1.8556
Epoch [22/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 7362, 'reflen': 10832, 'guess': [7362, 6997, 6632, 6267], 'correct': [2505, 983, 446, 172]}
ratio: 0.6796528803544424
Bleu_1: 0.212
Bleu_2: 0.136
Bleu_3: 0.092
Bleu_4: 0.060
computing METEOR score...
METEOR: 0.112
computing Rouge score...
ROUGE_L: 0.210
computing CIDEr score...
CIDEr: 0.095
dict_items([('Bleu_1', 0.21237913893168173), ('Bleu_2', 0.1364667092365356), ('Bleu_3', 0.09211872237704952), ('Bleu_4', 0.06049271854741878), ('METEOR', 0.1116569793202999), ('ROUGE_L', 0.20956660054414758), ('CIDEr', 0.0954384983359723)])
Epoch [23/30], Step [0/23], Loss: 0.5525, Perplexity: 1.7375
Epoch [23/30], Step [10/23], Loss: 0.7095, Perplexity: 2.0329
Epoch [23/30], Step [20/23], Loss: 0.8401, Perplexity: 2.3167
Epoch [23/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 6824, 'reflen': 10832, 'guess': [6824, 6459, 6094, 5729], 'correct': [2294, 895, 397, 137]}
ratio: 0.6299852289511974
Bleu_1: 0.187
Bleu_2: 0.120
Bleu_3: 0.080
Bleu_4: 0.051
computing METEOR score...
METEOR: 0.105
computing Rouge score...
ROUGE_L: 0.200
computing CIDEr score...
CIDEr: 0.086
dict_items([('Bleu_1', 0.18684281152320847), ('Bleu_2', 0.11995768374599856), ('Bleu_3', 0.08046778854612018), ('Bleu_4', 0.05129883298521507), ('METEOR', 0.10493152163227185), ('ROUGE_L', 0.19978051797164428), ('CIDEr', 0.0862763640739962)])
Epoch [24/30], Step [0/23], Loss: 0.6168, Perplexity: 1.8531
Epoch [24/30], Step [10/23], Loss: 0.5752, Perplexity: 1.7775
Epoch [24/30], Step [20/23], Loss: 0.6307, Perplexity: 1.8790
Epoch [24/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 6213, 'reflen': 10832, 'guess': [6213, 5848, 5483, 5118], 'correct': [2275, 930, 403, 122]}
ratio: 0.5735782865582927
Bleu_1: 0.174
Bleu_2: 0.115
Bleu_3: 0.077
Bleu_4: 0.048
computing METEOR score...
METEOR: 0.109
computing Rouge score...
ROUGE_L: 0.214
computing CIDEr score...
CIDEr: 0.130
dict_items([('Bleu_1', 0.17410355895242327), ('Bleu_2', 0.1147375091468098), ('Bleu_3', 0.07719842007248681), ('Bleu_4', 0.04778626606485381), ('METEOR', 0.10923542205275878), ('ROUGE_L', 0.21383990242674225), ('CIDEr', 0.1300126404161155)])
Epoch [25/30], Step [0/23], Loss: 0.6181, Perplexity: 1.8555
Epoch [25/30], Step [10/23], Loss: 0.6241, Perplexity: 1.8666
Epoch [25/30], Step [20/23], Loss: 0.6226, Perplexity: 1.8638
Epoch [25/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 7478, 'reflen': 10832, 'guess': [7478, 7113, 6748, 6383], 'correct': [2496, 948, 405, 126]}
ratio: 0.6903618906941755
Bleu_1: 0.213
Bleu_2: 0.135
Bleu_3: 0.089
Bleu_4: 0.054
computing METEOR score...
METEOR: 0.111
computing Rouge score...
ROUGE_L: 0.206
computing CIDEr score...
CIDEr: 0.104
dict_items([('Bleu_1', 0.21314308634212586), ('Bleu_2', 0.13468506938747296), ('Bleu_3', 0.08858842815874975), ('Bleu_4', 0.05440918299873393), ('METEOR', 0.11078610880622773), ('ROUGE_L', 0.20620152343406178), ('CIDEr', 0.10366812736683953)])
Epoch [26/30], Step [0/23], Loss: 0.7234, Perplexity: 2.0615
Epoch [26/30], Step [10/23], Loss: 0.6280, Perplexity: 1.8739
Epoch [26/30], Step [20/23], Loss: 0.7090, Perplexity: 2.0320
Epoch [26/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 5475, 'reflen': 10832, 'guess': [5475, 5110, 4745, 4380], 'correct': [1599, 605, 244, 39]}
ratio: 0.5054468242244733
Bleu_1: 0.110
Bleu_2: 0.070
Bleu_3: 0.046
Bleu_4: 0.024
computing METEOR score...
METEOR: 0.082
computing Rouge score...
ROUGE_L: 0.170
computing CIDEr score...
CIDEr: 0.052
dict_items([('Bleu_1', 0.1097817109812684), ('Bleu_2', 0.06989805035183425), ('Bleu_3', 0.04553896225414582), ('Bleu_4', 0.023711082690125142), ('METEOR', 0.08205298951395265), ('ROUGE_L', 0.17030388378672412), ('CIDEr', 0.051987561022167325)])
Epoch [27/30], Step [0/23], Loss: 0.5290, Perplexity: 1.6972
Epoch [27/30], Step [10/23], Loss: 0.4927, Perplexity: 1.6367
Epoch [27/30], Step [20/23], Loss: 0.5642, Perplexity: 1.7580
Epoch [27/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 5877, 'reflen': 10832, 'guess': [5877, 5512, 5147, 4782], 'correct': [1879, 723, 285, 48]}
ratio: 0.5425590841949277
Bleu_1: 0.138
Bleu_2: 0.088
Bleu_3: 0.057
Bleu_4: 0.030
computing METEOR score...
METEOR: 0.095
computing Rouge score...
ROUGE_L: 0.185
computing CIDEr score...
CIDEr: 0.089
dict_items([('Bleu_1', 0.1375973043870868), ('Bleu_2', 0.08813307546615573), ('Bleu_3', 0.056990499011002664), ('Bleu_4', 0.02990332426772691), ('METEOR', 0.09497271972190656), ('ROUGE_L', 0.18515485157349035), ('CIDEr', 0.08898534614182364)])
Epoch [28/30], Step [0/23], Loss: 0.5025, Perplexity: 1.6529
Epoch [28/30], Step [10/23], Loss: 0.5563, Perplexity: 1.7442
Epoch [28/30], Step [20/23], Loss: 0.5841, Perplexity: 1.7934
Epoch [28/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 5475, 'reflen': 10832, 'guess': [5475, 5110, 4745, 4380], 'correct': [1599, 605, 244, 39]}
ratio: 0.5054468242244733
Bleu_1: 0.110
Bleu_2: 0.070
Bleu_3: 0.046
Bleu_4: 0.024
computing METEOR score...
METEOR: 0.082
computing Rouge score...
ROUGE_L: 0.170
computing CIDEr score...
CIDEr: 0.052
dict_items([('Bleu_1', 0.1097817109812684), ('Bleu_2', 0.06989805035183425), ('Bleu_3', 0.04553896225414582), ('Bleu_4', 0.023711082690125142), ('METEOR', 0.08205298951395265), ('ROUGE_L', 0.17030388378672412), ('CIDEr', 0.051987561022167325)])
Epoch [29/30], Step [0/23], Loss: 0.5260, Perplexity: 1.6921
Epoch [29/30], Step [10/23], Loss: 0.5540, Perplexity: 1.7402
Epoch [29/30], Step [20/23], Loss: 0.6799, Perplexity: 1.9737
Epoch [29/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 7460, 'reflen': 10832, 'guess': [7460, 7095, 6730, 6365], 'correct': [2564, 1015, 442, 145]}
ratio: 0.6887001477104239
Bleu_1: 0.219
Bleu_2: 0.141
Bleu_3: 0.094
Bleu_4: 0.059
computing METEOR score...
METEOR: 0.115
computing Rouge score...
ROUGE_L: 0.213
computing CIDEr score...
CIDEr: 0.131
dict_items([('Bleu_1', 0.21871241207612624), ('Bleu_2', 0.14110443196765604), ('Bleu_3', 0.09405767743571287), ('Bleu_4', 0.05893342014125182), ('METEOR', 0.11547692912493597), ('ROUGE_L', 0.21253922785818644), ('CIDEr', 0.1306615302234124)])
