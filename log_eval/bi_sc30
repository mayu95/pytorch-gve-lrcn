Arguments:
data_path                     ./data
checkpoint_path               ./checkpoints
log_step                      10
num_workers                   4
disable_cuda                  False
cuda_device                   0
torch_seed                    16472186795827311700
model                         gve
dataset                       iu
pretrained_model              vgg16
layers_to_truncate            1
sc_ckpt                       ./data/iu/sentence_classifier_ckpt.pth
weights_ckpt                  None
loss_lambda                   0.2
embedding_size                1000
hidden_size                   1000
num_epochs                    30
batch_size                    128
learning_rate                 0.001
train                         True
eval_ckpt                     None

Preparing Data ...
loading annotations into memory...
Done (t=0.04s)
creating index...
index created!
loading annotations into memory...
Done (t=0.00s)
creating index...
index created!

Loading Model ...
embed_size: 1000
GVE(
  (vision_model): PretrainedModel(
    (pretrained_model): VGG(
      (features): Sequential(
        (0): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (1): ReLU(inplace)
        (2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (3): ReLU(inplace)
        (4): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
        (5): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (6): ReLU(inplace)
        (7): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (8): ReLU(inplace)
        (9): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
        (10): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (11): ReLU(inplace)
        (12): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (13): ReLU(inplace)
        (14): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (15): ReLU(inplace)
        (16): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
        (17): Conv2d(256, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (18): ReLU(inplace)
        (19): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (20): ReLU(inplace)
        (21): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (22): ReLU(inplace)
        (23): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
        (24): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (25): ReLU(inplace)
        (26): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (27): ReLU(inplace)
        (28): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (29): ReLU(inplace)
        (30): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
      )
      (avgpool): AdaptiveAvgPool2d(output_size=(7, 7))
      (classifier): Sequential(
        (0): Linear(in_features=25088, out_features=4096, bias=True)
        (1): ReLU(inplace)
        (2): Dropout(p=0.5)
        (3): Linear(in_features=4096, out_features=4096, bias=True)
        (4): ReLU(inplace)
        (5): Dropout(p=0.5)
      )
    )
  )
  (word_embed): Embedding(978, 1000, padding_idx=0)
  (linear1): Linear(in_features=4096, out_features=1000, bias=True)
  (lstm1): LSTM(1000, 1000, batch_first=True)
  (lstm2): LSTM(2017, 1000, batch_first=True)
  (linear2): Linear(in_features=1000, out_features=978, bias=True)
  (sentence_classifier): SentenceClassifier(
    (word_embed): Embedding(978, 1000, padding_idx=0)
    (lstm): LSTM(1000, 2000, batch_first=True, bidirectional=True)
    (linear): Linear(in_features=4000, out_features=17, bias=True)
  )
) 

Training ...
Epoch [0/30], Step [0/23], Loss: 8.5923, Perplexity: 5390.0963
Epoch [0/30], Step [10/23], Loss: 4.7978, Perplexity: 121.2471
Epoch [0/30], Step [20/23], Loss: 5.1296, Perplexity: 168.9570
Epoch [0/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 7679, 'reflen': 10832, 'guess': [7679, 7314, 6949, 6584], 'correct': [2781, 531, 140, 0]}
ratio: 0.7089180206794028
Bleu_1: 0.240
Bleu_2: 0.108
Bleu_3: 0.054
Bleu_4: 0.000
computing METEOR score...
METEOR: 0.089
computing Rouge score...
ROUGE_L: 0.235
computing CIDEr score...
CIDEr: 0.071
dict_items([('Bleu_1', 0.24020102701420504), ('Bleu_2', 0.10754654967930898), ('Bleu_3', 0.05366515756279818), ('Bleu_4', 1.9863989899799877e-06), ('METEOR', 0.08873986278926582), ('ROUGE_L', 0.23514647609696238), ('CIDEr', 0.07073629752561118)])
Epoch [1/30], Step [0/23], Loss: 4.9157, Perplexity: 136.4191
Epoch [1/30], Step [10/23], Loss: 4.2804, Perplexity: 72.2725
Epoch [1/30], Step [20/23], Loss: 3.7291, Perplexity: 41.6414
Epoch [1/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 6335, 'reflen': 10832, 'guess': [6335, 5970, 5605, 5240], 'correct': [3418, 1748, 798, 333]}
ratio: 0.584841211225943
Bleu_1: 0.265
Bleu_2: 0.195
Bleu_3: 0.139
Bleu_4: 0.096
computing METEOR score...
METEOR: 0.151
computing Rouge score...
ROUGE_L: 0.339
computing CIDEr score...
CIDEr: 0.131
dict_items([('Bleu_1', 0.26529839864752564), ('Bleu_2', 0.19543640151835207), ('Bleu_3', 0.1387977607609544), ('Bleu_4', 0.09560759170440118), ('METEOR', 0.15084503534736393), ('ROUGE_L', 0.33872888983491484), ('CIDEr', 0.1310985137971815)])
Epoch [2/30], Step [0/23], Loss: 3.8881, Perplexity: 48.8176
Epoch [2/30], Step [10/23], Loss: 3.1863, Perplexity: 24.1995
Epoch [2/30], Step [20/23], Loss: 2.8930, Perplexity: 18.0482
Epoch [2/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 9490, 'reflen': 10832, 'guess': [9490, 9125, 8760, 8395], 'correct': [5417, 2586, 1355, 615]}
ratio: 0.8761078286557537
Bleu_1: 0.496
Bleu_2: 0.349
Bleu_3: 0.254
Bleu_4: 0.180
computing METEOR score...
METEOR: 0.233
computing Rouge score...
ROUGE_L: 0.362
computing CIDEr score...
CIDEr: 0.462
dict_items([('Bleu_1', 0.49553937231984063), ('Bleu_2', 0.34916417560755175), ('Bleu_3', 0.25391792658197926), ('Bleu_4', 0.17963047237535748), ('METEOR', 0.2332007433368189), ('ROUGE_L', 0.3619481040587254), ('CIDEr', 0.461987342899745)])
Epoch [3/30], Step [0/23], Loss: 2.5859, Perplexity: 13.2750
Epoch [3/30], Step [10/23], Loss: 2.4835, Perplexity: 11.9837
Epoch [3/30], Step [20/23], Loss: 2.1283, Perplexity: 8.4002
Epoch [3/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 12410, 'reflen': 10832, 'guess': [12410, 12045, 11680, 11315], 'correct': [5093, 2370, 1389, 887]}
ratio: 1.1456794682421394
Bleu_1: 0.410
Bleu_2: 0.284
Bleu_3: 0.213
Bleu_4: 0.166
computing METEOR score...
METEOR: 0.204
computing Rouge score...
ROUGE_L: 0.345
computing CIDEr score...
CIDEr: 0.706
dict_items([('Bleu_1', 0.4103948428686212), ('Bleu_2', 0.2841657409598994), ('Bleu_3', 0.21255318307840698), ('Bleu_4', 0.1656410501443222), ('METEOR', 0.2041329546838664), ('ROUGE_L', 0.3450181275917098), ('CIDEr', 0.705841836402278)])
Epoch [4/30], Step [0/23], Loss: 2.1536, Perplexity: 8.6157
Epoch [4/30], Step [10/23], Loss: 1.7811, Perplexity: 5.9365
Epoch [4/30], Step [20/23], Loss: 1.9570, Perplexity: 7.0783
Epoch [4/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 11513, 'reflen': 10832, 'guess': [11513, 11148, 10783, 10418], 'correct': [4829, 2108, 1106, 611]}
ratio: 1.0628692762185135
Bleu_1: 0.419
Bleu_2: 0.282
Bleu_3: 0.201
Bleu_4: 0.148
computing METEOR score...
METEOR: 0.195
computing Rouge score...
ROUGE_L: 0.335
computing CIDEr score...
CIDEr: 0.512
dict_items([('Bleu_1', 0.4194388951619544), ('Bleu_2', 0.28162497982418466), ('Bleu_3', 0.2011187786609322), ('Bleu_4', 0.14779293762694345), ('METEOR', 0.19474899346427146), ('ROUGE_L', 0.33478259787909553), ('CIDEr', 0.5116116520804256)])
Epoch [5/30], Step [0/23], Loss: 1.8455, Perplexity: 6.3313
Epoch [5/30], Step [10/23], Loss: 1.4957, Perplexity: 4.4623
Epoch [5/30], Step [20/23], Loss: 1.2805, Perplexity: 3.5984
Epoch [5/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 7262, 'reflen': 10832, 'guess': [7262, 6897, 6532, 6167], 'correct': [4317, 2076, 1074, 429]}
ratio: 0.6704209748891552
Bleu_1: 0.364
Bleu_2: 0.259
Bleu_3: 0.189
Bleu_4: 0.130
computing METEOR score...
METEOR: 0.185
computing Rouge score...
ROUGE_L: 0.366
computing CIDEr score...
CIDEr: 0.327
dict_items([('Bleu_1', 0.36360227254245986), ('Bleu_2', 0.2587302740291113), ('Bleu_3', 0.1888213633456889), ('Bleu_4', 0.13009463259304938), ('METEOR', 0.1846655732788506), ('ROUGE_L', 0.3656767804201218), ('CIDEr', 0.327429515179015)])
Epoch [6/30], Step [0/23], Loss: 1.8190, Perplexity: 6.1656
Epoch [6/30], Step [10/23], Loss: 1.3320, Perplexity: 3.7887
Epoch [6/30], Step [20/23], Loss: 1.4938, Perplexity: 4.4539
Epoch [6/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 12410, 'reflen': 10832, 'guess': [12410, 12045, 11680, 11315], 'correct': [5093, 2370, 1389, 887]}
ratio: 1.1456794682421394
Bleu_1: 0.410
Bleu_2: 0.284
Bleu_3: 0.213
Bleu_4: 0.166
computing METEOR score...
METEOR: 0.204
computing Rouge score...
ROUGE_L: 0.345
computing CIDEr score...
CIDEr: 0.706
dict_items([('Bleu_1', 0.4103948428686212), ('Bleu_2', 0.2841657409598994), ('Bleu_3', 0.21255318307840698), ('Bleu_4', 0.1656410501443222), ('METEOR', 0.2041329546838664), ('ROUGE_L', 0.3450181275917098), ('CIDEr', 0.705841836402278)])
Epoch [7/30], Step [0/23], Loss: 1.3691, Perplexity: 3.9318
Epoch [7/30], Step [10/23], Loss: 1.4647, Perplexity: 4.3261
Epoch [7/30], Step [20/23], Loss: 1.4325, Perplexity: 4.1893
Epoch [7/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 12410, 'reflen': 10832, 'guess': [12410, 12045, 11680, 11315], 'correct': [5093, 2370, 1389, 887]}
ratio: 1.1456794682421394
Bleu_1: 0.410
Bleu_2: 0.284
Bleu_3: 0.213
Bleu_4: 0.166
computing METEOR score...
METEOR: 0.204
computing Rouge score...
ROUGE_L: 0.345
computing CIDEr score...
CIDEr: 0.706
dict_items([('Bleu_1', 0.4103948428686212), ('Bleu_2', 0.2841657409598994), ('Bleu_3', 0.21255318307840698), ('Bleu_4', 0.1656410501443222), ('METEOR', 0.2041329546838664), ('ROUGE_L', 0.3450181275917098), ('CIDEr', 0.705841836402278)])
Epoch [8/30], Step [0/23], Loss: 1.1693, Perplexity: 3.2198
Epoch [8/30], Step [10/23], Loss: 1.1126, Perplexity: 3.0424
Epoch [8/30], Step [20/23], Loss: 1.3130, Perplexity: 3.7172
Epoch [8/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 12410, 'reflen': 10832, 'guess': [12410, 12045, 11680, 11315], 'correct': [5093, 2370, 1389, 887]}
ratio: 1.1456794682421394
Bleu_1: 0.410
Bleu_2: 0.284
Bleu_3: 0.213
Bleu_4: 0.166
computing METEOR score...
METEOR: 0.204
computing Rouge score...
ROUGE_L: 0.345
computing CIDEr score...
CIDEr: 0.706
dict_items([('Bleu_1', 0.4103948428686212), ('Bleu_2', 0.2841657409598994), ('Bleu_3', 0.21255318307840698), ('Bleu_4', 0.1656410501443222), ('METEOR', 0.2041329546838664), ('ROUGE_L', 0.3450181275917098), ('CIDEr', 0.705841836402278)])
Epoch [9/30], Step [0/23], Loss: 1.2709, Perplexity: 3.5641
Epoch [9/30], Step [10/23], Loss: 2.5182, Perplexity: 12.4069
Epoch [9/30], Step [20/23], Loss: 2.5462, Perplexity: 12.7583
Epoch [9/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 12925, 'reflen': 10832, 'guess': [12925, 12560, 12195, 11830], 'correct': [5650, 2463, 1152, 452]}
ratio: 1.1932237813883684
Bleu_1: 0.437
Bleu_2: 0.293
Bleu_3: 0.201
Bleu_4: 0.133
computing METEOR score...
METEOR: 0.222
computing Rouge score...
ROUGE_L: 0.367
computing CIDEr score...
CIDEr: 0.293
dict_items([('Bleu_1', 0.4371373307543182), ('Bleu_2', 0.29278332209685926), ('Bleu_3', 0.20081113044909304), ('Bleu_4', 0.13262617919134037), ('METEOR', 0.22209689937102628), ('ROUGE_L', 0.3669289105465439), ('CIDEr', 0.29277458490451863)])
Epoch [10/30], Step [0/23], Loss: 2.0893, Perplexity: 8.0794
Epoch [10/30], Step [10/23], Loss: 2.1784, Perplexity: 8.8324
Epoch [10/30], Step [20/23], Loss: 2.0640, Perplexity: 7.8772
Epoch [10/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 10585, 'reflen': 10832, 'guess': [10585, 10220, 9855, 9490], 'correct': [4801, 2030, 959, 440]}
ratio: 0.9771971935006483
Bleu_1: 0.443
Bleu_2: 0.293
Bleu_3: 0.201
Bleu_4: 0.139
computing METEOR score...
METEOR: 0.202
computing Rouge score...
ROUGE_L: 0.356
computing CIDEr score...
CIDEr: 0.241
dict_items([('Bleu_1', 0.4431049706571962), ('Bleu_2', 0.29323025033033034), ('Bleu_3', 0.20144126175219), ('Bleu_4', 0.13871530635260254), ('METEOR', 0.20186283655251153), ('ROUGE_L', 0.3561148580351899), ('CIDEr', 0.24129259585175075)])
Epoch [11/30], Step [0/23], Loss: 2.3730, Perplexity: 10.7295
Epoch [11/30], Step [10/23], Loss: 2.2586, Perplexity: 9.5700
Epoch [11/30], Step [20/23], Loss: 2.5625, Perplexity: 12.9677
Epoch [11/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 13342, 'reflen': 10832, 'guess': [13342, 12977, 12612, 12247], 'correct': [5071, 2090, 1045, 525]}
ratio: 1.231720827178616
Bleu_1: 0.380
Bleu_2: 0.247
Bleu_3: 0.172
Bleu_4: 0.121
computing METEOR score...
METEOR: 0.209
computing Rouge score...
ROUGE_L: 0.335
computing CIDEr score...
CIDEr: 0.249
dict_items([('Bleu_1', 0.3800779493329051), ('Bleu_2', 0.2474128931904346), ('Bleu_3', 0.17181417642002045), ('Bleu_4', 0.12143018101331035), ('METEOR', 0.20852539232628703), ('ROUGE_L', 0.3346766812825181), ('CIDEr', 0.24941372917167867)])
Epoch [12/30], Step [0/23], Loss: 2.5894, Perplexity: 13.3218
Epoch [12/30], Step [10/23], Loss: 2.0211, Perplexity: 7.5466
Epoch [12/30], Step [20/23], Loss: 1.8172, Perplexity: 6.1544
Epoch [12/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 11315, 'reflen': 10832, 'guess': [11315, 10950, 10585, 10220], 'correct': [5045, 1988, 942, 420]}
ratio: 1.0445901033972447
Bleu_1: 0.446
Bleu_2: 0.285
Bleu_3: 0.193
Bleu_4: 0.131
computing METEOR score...
METEOR: 0.203
computing Rouge score...
ROUGE_L: 0.353
computing CIDEr score...
CIDEr: 0.187
dict_items([('Bleu_1', 0.4458683163941276), ('Bleu_2', 0.2845145208982459), ('Bleu_3', 0.1931329190398629), ('Bleu_4', 0.1311722074076396), ('METEOR', 0.20337889890365782), ('ROUGE_L', 0.3526550947851175), ('CIDEr', 0.18714822925442998)])
Epoch [13/30], Step [0/23], Loss: 2.0444, Perplexity: 7.7244
Epoch [13/30], Step [10/23], Loss: 2.0867, Perplexity: 8.0585
Epoch [13/30], Step [20/23], Loss: 2.4311, Perplexity: 11.3714
Epoch [13/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 14217, 'reflen': 10832, 'guess': [14217, 13852, 13487, 13122], 'correct': [5125, 2022, 977, 423]}
ratio: 1.3124999999998788
Bleu_1: 0.360
Bleu_2: 0.229
Bleu_3: 0.156
Bleu_4: 0.105
computing METEOR score...
METEOR: 0.198
computing Rouge score...
ROUGE_L: 0.317
computing CIDEr score...
CIDEr: 0.059
dict_items([('Bleu_1', 0.36048392769217413), ('Bleu_2', 0.22939148207764362), ('Bleu_3', 0.156210873287801), ('Bleu_4', 0.10528549146159531), ('METEOR', 0.19801164543292973), ('ROUGE_L', 0.3174792539201567), ('CIDEr', 0.05854589900843716)])
Epoch [14/30], Step [0/23], Loss: 2.4986, Perplexity: 12.1660
Epoch [14/30], Step [10/23], Loss: 2.1721, Perplexity: 8.7768
Epoch [14/30], Step [20/23], Loss: 2.0408, Perplexity: 7.6970
Epoch [14/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 14235, 'reflen': 10832, 'guess': [14235, 13870, 13505, 13140], 'correct': [5641, 2394, 1216, 547]}
ratio: 1.3141617429836305
Bleu_1: 0.396
Bleu_2: 0.262
Bleu_3: 0.183
Bleu_4: 0.127
computing METEOR score...
METEOR: 0.220
computing Rouge score...
ROUGE_L: 0.334
computing CIDEr score...
CIDEr: 0.229
dict_items([('Bleu_1', 0.3962767825781246), ('Bleu_2', 0.26153098929724305), ('Bleu_3', 0.18329970522606662), ('Bleu_4', 0.12653751903593694), ('METEOR', 0.21954064413742083), ('ROUGE_L', 0.33435282945344635), ('CIDEr', 0.22924320133203058)])
Epoch [15/30], Step [0/23], Loss: 1.9792, Perplexity: 7.2366
Epoch [15/30], Step [10/23], Loss: 2.0010, Perplexity: 7.3967
Epoch [15/30], Step [20/23], Loss: 2.1416, Perplexity: 8.5133
Epoch [15/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 11411, 'reflen': 10832, 'guess': [11411, 11046, 10681, 10316], 'correct': [4922, 1974, 994, 453]}
ratio: 1.0534527326439205
Bleu_1: 0.431
Bleu_2: 0.278
Bleu_3: 0.193
Bleu_4: 0.133
computing METEOR score...
METEOR: 0.190
computing Rouge score...
ROUGE_L: 0.339
computing CIDEr score...
CIDEr: 0.272
dict_items([('Bleu_1', 0.43133818245548755), ('Bleu_2', 0.2776387028786599), ('Bleu_3', 0.19286118354140996), ('Bleu_4', 0.13322334623152196), ('METEOR', 0.19023378629142898), ('ROUGE_L', 0.339493864134292), ('CIDEr', 0.27190114024617695)])
Epoch [16/30], Step [0/23], Loss: 1.9582, Perplexity: 7.0864
Epoch [16/30], Step [10/23], Loss: 1.8663, Perplexity: 6.4645
Epoch [16/30], Step [20/23], Loss: 1.5721, Perplexity: 4.8170
Epoch [16/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 11315, 'reflen': 10832, 'guess': [11315, 10950, 10585, 10220], 'correct': [4809, 2129, 1127, 518]}
ratio: 1.0445901033972447
Bleu_1: 0.425
Bleu_2: 0.287
Bleu_3: 0.206
Bleu_4: 0.145
computing METEOR score...
METEOR: 0.202
computing Rouge score...
ROUGE_L: 0.339
computing CIDEr score...
CIDEr: 0.214
dict_items([('Bleu_1', 0.42501104728233097), ('Bleu_2', 0.2874622897109197), ('Bleu_3', 0.20644210159977783), ('Bleu_4', 0.14531766793598172), ('METEOR', 0.20195665754749598), ('ROUGE_L', 0.3389720178121613), ('CIDEr', 0.21352213171497664)])
Epoch [17/30], Step [0/23], Loss: 1.4746, Perplexity: 4.3693
Epoch [17/30], Step [10/23], Loss: 2.1286, Perplexity: 8.4027
Epoch [17/30], Step [20/23], Loss: 1.7790, Perplexity: 5.9239
Epoch [17/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 14965, 'reflen': 10832, 'guess': [14965, 14600, 14235, 13870], 'correct': [5283, 2221, 1113, 443]}
ratio: 1.381554652880227
Bleu_1: 0.353
Bleu_2: 0.232
Bleu_3: 0.161
Bleu_4: 0.108
computing METEOR score...
METEOR: 0.200
computing Rouge score...
ROUGE_L: 0.331
computing CIDEr score...
CIDEr: 0.124
dict_items([('Bleu_1', 0.3530237220180185), ('Bleu_2', 0.23173935621579841), ('Bleu_3', 0.16132899500063638), ('Bleu_4', 0.10761334662764872), ('METEOR', 0.20031195266327492), ('ROUGE_L', 0.33091981175947893), ('CIDEr', 0.12449063507023267)])
Epoch [18/30], Step [0/23], Loss: 1.7935, Perplexity: 6.0103
Epoch [18/30], Step [10/23], Loss: 2.2125, Perplexity: 9.1388
Epoch [18/30], Step [20/23], Loss: 1.6141, Perplexity: 5.0234
Epoch [18/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 10915, 'reflen': 10832, 'guess': [10915, 10550, 10185, 9820], 'correct': [4673, 1838, 843, 302]}
ratio: 1.007662481536096
Bleu_1: 0.428
Bleu_2: 0.273
Bleu_3: 0.183
Bleu_4: 0.117
computing METEOR score...
METEOR: 0.192
computing Rouge score...
ROUGE_L: 0.332
computing CIDEr score...
CIDEr: 0.194
dict_items([('Bleu_1', 0.42812643151622276), ('Bleu_2', 0.27310681921906793), ('Bleu_3', 0.18344697014103375), ('Bleu_4', 0.1173834233936771), ('METEOR', 0.1922058845674703), ('ROUGE_L', 0.3323120788525454), ('CIDEr', 0.19419095450528412)])
Epoch [19/30], Step [0/23], Loss: 1.6955, Perplexity: 5.4496
Epoch [19/30], Step [10/23], Loss: 1.6705, Perplexity: 5.3148
Epoch [19/30], Step [20/23], Loss: 1.7432, Perplexity: 5.7158
Epoch [19/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 10585, 'reflen': 10832, 'guess': [10585, 10220, 9855, 9490], 'correct': [4648, 1962, 940, 392]}
ratio: 0.9771971935006483
Bleu_1: 0.429
Bleu_2: 0.284
Bleu_3: 0.196
Bleu_4: 0.132
computing METEOR score...
METEOR: 0.193
computing Rouge score...
ROUGE_L: 0.336
computing CIDEr score...
CIDEr: 0.176
dict_items([('Bleu_1', 0.4289839415985519), ('Bleu_2', 0.2836465204828336), ('Bleu_3', 0.19571794240809484), ('Bleu_4', 0.13188469193712998), ('METEOR', 0.19258581007671105), ('ROUGE_L', 0.33629583524821177), ('CIDEr', 0.17600711983660688)])
Epoch [20/30], Step [0/23], Loss: 1.7525, Perplexity: 5.7692
Epoch [20/30], Step [10/23], Loss: 1.6359, Perplexity: 5.1340
Epoch [20/30], Step [20/23], Loss: 1.6633, Perplexity: 5.2766
Epoch [20/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 14235, 'reflen': 10832, 'guess': [14235, 13870, 13505, 13140], 'correct': [5330, 2244, 1075, 421]}
ratio: 1.3141617429836305
Bleu_1: 0.374
Bleu_2: 0.246
Bleu_3: 0.169
Bleu_4: 0.111
computing METEOR score...
METEOR: 0.208
computing Rouge score...
ROUGE_L: 0.315
computing CIDEr score...
CIDEr: 0.212
dict_items([('Bleu_1', 0.3744292237442659), ('Bleu_2', 0.246126323519458), ('Bleu_3', 0.1689442187753136), ('Bleu_4', 0.11148827190642507), ('METEOR', 0.2084775507175331), ('ROUGE_L', 0.31516056793541586), ('CIDEr', 0.21189383865826278)])
Epoch [21/30], Step [0/23], Loss: 1.8274, Perplexity: 6.2175
Epoch [21/30], Step [10/23], Loss: 1.6756, Perplexity: 5.3418
Epoch [21/30], Step [20/23], Loss: 1.6248, Perplexity: 5.0775
Epoch [21/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 14235, 'reflen': 10832, 'guess': [14235, 13870, 13505, 13140], 'correct': [5330, 2244, 1075, 421]}
ratio: 1.3141617429836305
Bleu_1: 0.374
Bleu_2: 0.246
Bleu_3: 0.169
Bleu_4: 0.111
computing METEOR score...
METEOR: 0.208
computing Rouge score...
ROUGE_L: 0.315
computing CIDEr score...
CIDEr: 0.212
dict_items([('Bleu_1', 0.3744292237442659), ('Bleu_2', 0.246126323519458), ('Bleu_3', 0.1689442187753136), ('Bleu_4', 0.11148827190642507), ('METEOR', 0.2084775507175331), ('ROUGE_L', 0.31516056793541586), ('CIDEr', 0.21189383865826278)])
Epoch [22/30], Step [0/23], Loss: 1.3897, Perplexity: 4.0136
Epoch [22/30], Step [10/23], Loss: 1.4091, Perplexity: 4.0925
Epoch [22/30], Step [20/23], Loss: 1.3546, Perplexity: 3.8753
Epoch [22/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 14235, 'reflen': 10832, 'guess': [14235, 13870, 13505, 13140], 'correct': [5322, 2229, 1053, 392]}
ratio: 1.3141617429836305
Bleu_1: 0.374
Bleu_2: 0.245
Bleu_3: 0.167
Bleu_4: 0.109
computing METEOR score...
METEOR: 0.207
computing Rouge score...
ROUGE_L: 0.315
computing CIDEr score...
CIDEr: 0.185
dict_items([('Bleu_1', 0.37386722866172295), ('Bleu_2', 0.2451181685636131), ('Bleu_3', 0.1673252938115701), ('Bleu_4', 0.1087286191772161), ('METEOR', 0.2071187684765641), ('ROUGE_L', 0.3145942407249477), ('CIDEr', 0.18495562415151112)])
Epoch [23/30], Step [0/23], Loss: 1.4245, Perplexity: 4.1556
Epoch [23/30], Step [10/23], Loss: 1.3541, Perplexity: 3.8731
Epoch [23/30], Step [20/23], Loss: 1.3367, Perplexity: 3.8063
Epoch [23/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 15330, 'reflen': 10832, 'guess': [15330, 14965, 14600, 14235], 'correct': [5384, 2150, 967, 303]}
ratio: 1.415251107828525
Bleu_1: 0.351
Bleu_2: 0.225
Bleu_3: 0.150
Bleu_4: 0.092
computing METEOR score...
METEOR: 0.204
computing Rouge score...
ROUGE_L: 0.300
computing CIDEr score...
CIDEr: 0.115
dict_items([('Bleu_1', 0.3512067840834735), ('Bleu_2', 0.2246271865160421), ('Bleu_3', 0.14950856891303604), ('Bleu_4', 0.09183766911869166), ('METEOR', 0.20355796663279507), ('ROUGE_L', 0.30047835958812347), ('CIDEr', 0.115050279732774)])
Epoch [24/30], Step [0/23], Loss: 1.4115, Perplexity: 4.1020
Epoch [24/30], Step [10/23], Loss: 1.6477, Perplexity: 5.1948
Epoch [24/30], Step [20/23], Loss: 1.3935, Perplexity: 4.0290
Epoch [24/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 12775, 'reflen': 10832, 'guess': [12775, 12410, 12045, 11680], 'correct': [5632, 2296, 1062, 510]}
ratio: 1.1793759231904375
Bleu_1: 0.441
Bleu_2: 0.286
Bleu_3: 0.193
Bleu_4: 0.133
computing METEOR score...
METEOR: 0.220
computing Rouge score...
ROUGE_L: 0.358
computing CIDEr score...
CIDEr: 0.227
dict_items([('Bleu_1', 0.44086105675143317), ('Bleu_2', 0.28559521039107894), ('Bleu_3', 0.19302186936071244), ('Bleu_4', 0.133117980775691), ('METEOR', 0.219765425671659), ('ROUGE_L', 0.35831536400890024), ('CIDEr', 0.22724838779872114)])
Epoch [25/30], Step [0/23], Loss: 1.3639, Perplexity: 3.9115
Epoch [25/30], Step [10/23], Loss: 1.4977, Perplexity: 4.4712
Epoch [25/30], Step [20/23], Loss: 1.8368, Perplexity: 6.2765
Epoch [25/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 11680, 'reflen': 10832, 'guess': [11680, 11315, 10950, 10585], 'correct': [4649, 2062, 1001, 403]}
ratio: 1.078286558345543
Bleu_1: 0.398
Bleu_2: 0.269
Bleu_3: 0.188
Bleu_4: 0.126
computing METEOR score...
METEOR: 0.187
computing Rouge score...
ROUGE_L: 0.326
computing CIDEr score...
CIDEr: 0.223
dict_items([('Bleu_1', 0.3980308219177741), ('Bleu_2', 0.26932421521788363), ('Bleu_3', 0.18786977768709348), ('Bleu_4', 0.12605098305701865), ('METEOR', 0.187476746538342), ('ROUGE_L', 0.3258840098332429), ('CIDEr', 0.22264826224284803)])
Epoch [26/30], Step [0/23], Loss: 1.6287, Perplexity: 5.0975
Epoch [26/30], Step [10/23], Loss: 1.5005, Perplexity: 4.4841
Epoch [26/30], Step [20/23], Loss: 1.4969, Perplexity: 4.4678
Epoch [26/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 11430, 'reflen': 10832, 'guess': [11430, 11065, 10700, 10335], 'correct': [4799, 1887, 831, 366]}
ratio: 1.055206794682325
Bleu_1: 0.420
Bleu_2: 0.268
Bleu_3: 0.177
Bleu_4: 0.118
computing METEOR score...
METEOR: 0.189
computing Rouge score...
ROUGE_L: 0.322
computing CIDEr score...
CIDEr: 0.251
dict_items([('Bleu_1', 0.419860017497776), ('Bleu_2', 0.2675854535802667), ('Bleu_3', 0.17716615063777105), ('Bleu_4', 0.11846176880392668), ('METEOR', 0.18889476550142212), ('ROUGE_L', 0.3222347051927136), ('CIDEr', 0.2509459990375271)])
Epoch [27/30], Step [0/23], Loss: 1.4786, Perplexity: 4.3866
Epoch [27/30], Step [10/23], Loss: 1.3966, Perplexity: 4.0413
Epoch [27/30], Step [20/23], Loss: 1.3960, Perplexity: 4.0390
Epoch [27/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 10950, 'reflen': 10832, 'guess': [10950, 10585, 10220, 9855], 'correct': [4607, 1867, 913, 388]}
ratio: 1.0108936484489466
Bleu_1: 0.421
Bleu_2: 0.272
Bleu_3: 0.188
Bleu_4: 0.127
computing METEOR score...
METEOR: 0.176
computing Rouge score...
ROUGE_L: 0.330
computing CIDEr score...
CIDEr: 0.233
dict_items([('Bleu_1', 0.4207305936072675), ('Bleu_2', 0.2724135929734807), ('Bleu_3', 0.1878563198428872), ('Bleu_4', 0.1271051454198669), ('METEOR', 0.17614893964720282), ('ROUGE_L', 0.3301986094133974), ('CIDEr', 0.2329830037168798)])
Epoch [28/30], Step [0/23], Loss: 1.6879, Perplexity: 5.4082
Epoch [28/30], Step [10/23], Loss: 1.4263, Perplexity: 4.1631
Epoch [28/30], Step [20/23], Loss: 1.4039, Perplexity: 4.0708
Epoch [28/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 10220, 'reflen': 10832, 'guess': [10220, 9855, 9490, 9125], 'correct': [4400, 1687, 693, 298]}
ratio: 0.9435007385523501
Bleu_1: 0.406
Bleu_2: 0.256
Bleu_3: 0.165
Bleu_4: 0.108
computing METEOR score...
METEOR: 0.179
computing Rouge score...
ROUGE_L: 0.321
computing CIDEr score...
CIDEr: 0.197
dict_items([('Bleu_1', 0.4055039651625638), ('Bleu_2', 0.255695710174587), ('Bleu_3', 0.16505768266383417), ('Bleu_4', 0.108447860001764), ('METEOR', 0.17862030512433638), ('ROUGE_L', 0.3209206004352692), ('CIDEr', 0.19736029721402923)])
Epoch [29/30], Step [0/23], Loss: 1.2371, Perplexity: 3.4456
Epoch [29/30], Step [10/23], Loss: 1.3024, Perplexity: 3.6783
Epoch [29/30], Step [20/23], Loss: 1.1367, Perplexity: 3.1163
Epoch [29/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 10585, 'reflen': 10832, 'guess': [10585, 10220, 9855, 9490], 'correct': [4581, 1822, 887, 379]}
ratio: 0.9771971935006483
Bleu_1: 0.423
Bleu_2: 0.271
Bleu_3: 0.186
Bleu_4: 0.126
computing METEOR score...
METEOR: 0.179
computing Rouge score...
ROUGE_L: 0.335
computing CIDEr score...
CIDEr: 0.242
dict_items([('Bleu_1', 0.42280022299117176), ('Bleu_2', 0.27136212494161177), ('Bleu_3', 0.18638476513340954), ('Bleu_4', 0.1260716689251446), ('METEOR', 0.17886879502970274), ('ROUGE_L', 0.33472133738031684), ('CIDEr', 0.24174856983680373)])
