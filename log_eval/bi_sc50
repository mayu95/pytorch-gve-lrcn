Arguments:
data_path                     ./data
checkpoint_path               ./checkpoints
log_step                      10
num_workers                   4
disable_cuda                  False
cuda_device                   0
torch_seed                    6825783737537237323
model                         gve
dataset                       iu
pretrained_model              vgg16
layers_to_truncate            1
sc_ckpt                       ./data/iu/sentence_classifier_ckpt.pth
weights_ckpt                  None
loss_lambda                   0.2
embedding_size                1000
hidden_size                   1000
num_epochs                    30
batch_size                    128
learning_rate                 0.001
train                         True
eval_ckpt                     None

Preparing Data ...
loading annotations into memory...
Done (t=0.04s)
creating index...
index created!
loading annotations into memory...
Done (t=0.00s)
creating index...
index created!

Loading Model ...
embed_size: 1000
GVE(
  (vision_model): PretrainedModel(
    (pretrained_model): VGG(
      (features): Sequential(
        (0): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (1): ReLU(inplace)
        (2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (3): ReLU(inplace)
        (4): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
        (5): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (6): ReLU(inplace)
        (7): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (8): ReLU(inplace)
        (9): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
        (10): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (11): ReLU(inplace)
        (12): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (13): ReLU(inplace)
        (14): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (15): ReLU(inplace)
        (16): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
        (17): Conv2d(256, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (18): ReLU(inplace)
        (19): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (20): ReLU(inplace)
        (21): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (22): ReLU(inplace)
        (23): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
        (24): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (25): ReLU(inplace)
        (26): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (27): ReLU(inplace)
        (28): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (29): ReLU(inplace)
        (30): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
      )
      (avgpool): AdaptiveAvgPool2d(output_size=(7, 7))
      (classifier): Sequential(
        (0): Linear(in_features=25088, out_features=4096, bias=True)
        (1): ReLU(inplace)
        (2): Dropout(p=0.5)
        (3): Linear(in_features=4096, out_features=4096, bias=True)
        (4): ReLU(inplace)
        (5): Dropout(p=0.5)
      )
    )
  )
  (word_embed): Embedding(978, 1000, padding_idx=0)
  (linear1): Linear(in_features=4096, out_features=1000, bias=True)
  (lstm1): LSTM(1000, 1000, batch_first=True)
  (lstm2): LSTM(2017, 1000, batch_first=True)
  (linear2): Linear(in_features=1000, out_features=978, bias=True)
  (sentence_classifier): SentenceClassifier(
    (word_embed): Embedding(978, 1000, padding_idx=0)
    (lstm): LSTM(1000, 2000, batch_first=True, bidirectional=True)
    (linear): Linear(in_features=4000, out_features=17, bias=True)
  )
) 

Training ...
Epoch [0/30], Step [0/23], Loss: 8.0087, Perplexity: 3006.8575
Epoch [0/30], Step [10/23], Loss: 12.4643, Perplexity: 258915.8007
Epoch [0/30], Step [20/23], Loss: 15.9962, Perplexity: 8852530.5411
Epoch [0/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 13122, 'reflen': 10832, 'guess': [13122, 12757, 12392, 12027], 'correct': [2435, 553, 168, 0]}
ratio: 1.211410635154984
Bleu_1: 0.186
Bleu_2: 0.090
Bleu_3: 0.048
Bleu_4: 0.000
computing METEOR score...
METEOR: 0.083
computing Rouge score...
ROUGE_L: 0.176
computing CIDEr score...
CIDEr: 0.036
dict_items([('Bleu_1', 0.18556622466086073), ('Bleu_2', 0.08968870512343516), ('Bleu_3', 0.04777651435565416), ('Bleu_4', 1.7352878200070372e-06), ('METEOR', 0.08271892029196899), ('ROUGE_L', 0.17636130250294407), ('CIDEr', 0.03594559332917158)])
Epoch [1/30], Step [0/23], Loss: 16.4175, Perplexity: 13491187.1421
Epoch [1/30], Step [10/23], Loss: 16.1458, Perplexity: 10280971.9263
Epoch [1/30], Step [20/23], Loss: 13.6283, Perplexity: 829302.0874
Epoch [1/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 6612, 'reflen': 10832, 'guess': [6612, 6247, 5882, 5517], 'correct': [2977, 1568, 751, 218]}
ratio: 0.6104135893647885
Bleu_1: 0.238
Bleu_2: 0.178
Bleu_3: 0.129
Bleu_4: 0.082
computing METEOR score...
METEOR: 0.134
computing Rouge score...
ROUGE_L: 0.319
computing CIDEr score...
CIDEr: 0.135
dict_items([('Bleu_1', 0.23782893773504676), ('Bleu_2', 0.1775738363587873), ('Bleu_3', 0.1285969078592694), ('Bleu_4', 0.08162363817809012), ('METEOR', 0.13407675348471906), ('ROUGE_L', 0.3194557626784029), ('CIDEr', 0.13498761839335877)])
Epoch [2/30], Step [0/23], Loss: 14.7904, Perplexity: 2650893.1550
Epoch [2/30], Step [10/23], Loss: 14.9718, Perplexity: 3178081.9308
Epoch [2/30], Step [20/23], Loss: 9.9938, Perplexity: 21889.5762
Epoch [2/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 8395, 'reflen': 10832, 'guess': [8395, 8030, 7665, 7300], 'correct': [4902, 2275, 1080, 350]}
ratio: 0.775018463810859
Bleu_1: 0.437
Bleu_2: 0.304
Bleu_3: 0.214
Bleu_4: 0.137
computing METEOR score...
METEOR: 0.210
computing Rouge score...
ROUGE_L: 0.418
computing CIDEr score...
CIDEr: 0.274
dict_items([('Bleu_1', 0.4367978198258862), ('Bleu_2', 0.304254553513632), ('Bleu_3', 0.21368360817610133), ('Bleu_4', 0.1367718326622008), ('METEOR', 0.2097800174418991), ('ROUGE_L', 0.41820311935323545), ('CIDEr', 0.2742211264128269)])
Epoch [3/30], Step [0/23], Loss: 12.3877, Perplexity: 239835.5272
Epoch [3/30], Step [10/23], Loss: 11.2846, Perplexity: 79586.9192
Epoch [3/30], Step [20/23], Loss: 8.7362, Perplexity: 6224.3077
Epoch [3/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 8395, 'reflen': 10832, 'guess': [8395, 8030, 7665, 7300], 'correct': [4908, 2237, 1071, 480]}
ratio: 0.775018463810859
Bleu_1: 0.437
Bleu_2: 0.302
Bleu_3: 0.212
Bleu_4: 0.147
computing METEOR score...
METEOR: 0.217
computing Rouge score...
ROUGE_L: 0.399
computing CIDEr score...
CIDEr: 0.334
dict_items([('Bleu_1', 0.4373324560802631), ('Bleu_2', 0.30188741022407717), ('Bleu_3', 0.21198170955600276), ('Bleu_4', 0.14712461890469714), ('METEOR', 0.21650831840854956), ('ROUGE_L', 0.39924504718133447), ('CIDEr', 0.3341437095192229)])
Epoch [4/30], Step [0/23], Loss: 8.5981, Perplexity: 5421.1874
Epoch [4/30], Step [10/23], Loss: 10.1398, Perplexity: 25331.6189
Epoch [4/30], Step [20/23], Loss: 9.8091, Perplexity: 18198.9682
Epoch [4/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 8060, 'reflen': 10832, 'guess': [8060, 7695, 7330, 6965], 'correct': [4448, 2135, 1138, 508]}
ratio: 0.744091580502147
Bleu_1: 0.391
Bleu_2: 0.277
Bleu_3: 0.204
Bleu_4: 0.145
computing METEOR score...
METEOR: 0.199
computing Rouge score...
ROUGE_L: 0.376
computing CIDEr score...
CIDEr: 0.316
dict_items([('Bleu_1', 0.39126132373066563), ('Bleu_2', 0.2774256927231845), ('Bleu_3', 0.20385573928554448), ('Bleu_4', 0.14467288793921906), ('METEOR', 0.1990302342922264), ('ROUGE_L', 0.3757354177442237), ('CIDEr', 0.3160552765153192)])
Epoch [5/30], Step [0/23], Loss: 9.7818, Perplexity: 17709.2811
Epoch [5/30], Step [10/23], Loss: 8.4693, Perplexity: 4766.2156
Epoch [5/30], Step [20/23], Loss: 9.3401, Perplexity: 11385.3872
Epoch [5/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 10950, 'reflen': 10832, 'guess': [10950, 10585, 10220, 9855], 'correct': [4868, 2464, 1368, 708]}
ratio: 1.0108936484489466
Bleu_1: 0.445
Bleu_2: 0.322
Bleu_3: 0.240
Bleu_4: 0.178
computing METEOR score...
METEOR: 0.208
computing Rouge score...
ROUGE_L: 0.363
computing CIDEr score...
CIDEr: 0.476
dict_items([('Bleu_1', 0.44456621004562147), ('Bleu_2', 0.32169413697785076), ('Bleu_3', 0.24016358863063533), ('Bleu_4', 0.17761291030978413), ('METEOR', 0.20847126412252678), ('ROUGE_L', 0.3630085402179755), ('CIDEr', 0.47647209528020756)])
Epoch [6/30], Step [0/23], Loss: 8.1496, Perplexity: 3461.9644
Epoch [6/30], Step [10/23], Loss: 8.4806, Perplexity: 4820.5314
Epoch [6/30], Step [20/23], Loss: 7.8830, Perplexity: 2651.8398
Epoch [6/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 11133, 'reflen': 10832, 'guess': [11133, 10768, 10403, 10038], 'correct': [5432, 2192, 1189, 628]}
ratio: 1.027788035450422
Bleu_1: 0.488
Bleu_2: 0.315
Bleu_3: 0.225
Bleu_4: 0.163
computing METEOR score...
METEOR: 0.222
computing Rouge score...
ROUGE_L: 0.371
computing CIDEr score...
CIDEr: 0.471
dict_items([('Bleu_1', 0.48791879996402693), ('Bleu_2', 0.3151566878279953), ('Bleu_3', 0.22474606872266983), ('Bleu_4', 0.1632477449971426), ('METEOR', 0.22168788837462183), ('ROUGE_L', 0.371107770083783), ('CIDEr', 0.471443798925364)])
Epoch [7/30], Step [0/23], Loss: 7.3641, Perplexity: 1578.3236
Epoch [7/30], Step [10/23], Loss: 8.5605, Perplexity: 5221.3965
Epoch [7/30], Step [20/23], Loss: 6.5014, Perplexity: 666.0684
Epoch [7/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 9855, 'reflen': 10832, 'guess': [9855, 9490, 9125, 8760], 'correct': [4830, 2059, 1063, 451]}
ratio: 0.9098042836040519
Bleu_1: 0.444
Bleu_2: 0.295
Bleu_3: 0.210
Bleu_4: 0.144
computing METEOR score...
METEOR: 0.206
computing Rouge score...
ROUGE_L: 0.363
computing CIDEr score...
CIDEr: 0.364
dict_items([('Bleu_1', 0.44384939852567384), ('Bleu_2', 0.29531496258506934), ('Bleu_3', 0.20954251048388994), ('Bleu_4', 0.143915807695695), ('METEOR', 0.20594927753468187), ('ROUGE_L', 0.3632453497913855), ('CIDEr', 0.3636362730044897)])
Epoch [8/30], Step [0/23], Loss: 6.7964, Perplexity: 894.5889
Epoch [8/30], Step [10/23], Loss: 7.3270, Perplexity: 1520.8598
Epoch [8/30], Step [20/23], Loss: 6.4554, Perplexity: 636.1187
Epoch [8/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 8030, 'reflen': 10832, 'guess': [8030, 7665, 7300, 6935], 'correct': [4203, 1680, 768, 365]}
ratio: 0.7413220088625608
Bleu_1: 0.369
Bleu_2: 0.239
Bleu_3: 0.162
Bleu_4: 0.112
computing METEOR score...
METEOR: 0.176
computing Rouge score...
ROUGE_L: 0.335
computing CIDEr score...
CIDEr: 0.301
dict_items([('Bleu_1', 0.3692329839287357), ('Bleu_2', 0.2389335462415955), ('Bleu_3', 0.16181412196857192), ('Bleu_4', 0.11199227755236318), ('METEOR', 0.17618410952747815), ('ROUGE_L', 0.3347357416512984), ('CIDEr', 0.30052131271216675)])
Epoch [9/30], Step [0/23], Loss: 6.8925, Perplexity: 984.9055
Epoch [9/30], Step [10/23], Loss: 6.5015, Perplexity: 666.1160
Epoch [9/30], Step [20/23], Loss: 7.0340, Perplexity: 1134.5700
Epoch [9/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 8498, 'reflen': 10832, 'guess': [8498, 8133, 7768, 7403], 'correct': [4045, 1981, 1121, 609]}
ratio: 0.7845273264401048
Bleu_1: 0.362
Bleu_2: 0.259
Bleu_3: 0.194
Bleu_4: 0.146
computing METEOR score...
METEOR: 0.176
computing Rouge score...
ROUGE_L: 0.357
computing CIDEr score...
CIDEr: 0.254
dict_items([('Bleu_1', 0.36167757144161866), ('Bleu_2', 0.25872448425968125), ('Bleu_3', 0.19434069196003237), ('Bleu_4', 0.14635418278331097), ('METEOR', 0.17567953326701957), ('ROUGE_L', 0.3572133760711648), ('CIDEr', 0.2544814872614444)])
Epoch [10/30], Step [0/23], Loss: 6.2190, Perplexity: 502.1770
Epoch [10/30], Step [10/23], Loss: 5.6382, Perplexity: 280.9691
Epoch [10/30], Step [20/23], Loss: 6.3774, Perplexity: 588.4247
Epoch [10/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 6570, 'reflen': 10832, 'guess': [6570, 6205, 5840, 5475], 'correct': [3404, 1473, 825, 395]}
ratio: 0.6065361890693679
Bleu_1: 0.271
Bleu_2: 0.183
Bleu_3: 0.135
Bleu_4: 0.098
computing METEOR score...
METEOR: 0.146
computing Rouge score...
ROUGE_L: 0.315
computing CIDEr score...
CIDEr: 0.312
dict_items([('Bleu_1', 0.27082867264961813), ('Bleu_2', 0.18332134325895943), ('Bleu_3', 0.13538769908970605), ('Bleu_4', 0.09835699766471756), ('METEOR', 0.14598450127278367), ('ROUGE_L', 0.3150373229451846), ('CIDEr', 0.31206104735788764)])
Epoch [11/30], Step [0/23], Loss: 6.2982, Perplexity: 543.6141
Epoch [11/30], Step [10/23], Loss: 5.7124, Perplexity: 302.6002
Epoch [11/30], Step [20/23], Loss: 5.6813, Perplexity: 293.3273
Epoch [11/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 9125, 'reflen': 10832, 'guess': [9125, 8760, 8395, 8030], 'correct': [4705, 2147, 1071, 516]}
ratio: 0.8424113737074554
Bleu_1: 0.428
Bleu_2: 0.295
Bleu_3: 0.210
Bleu_4: 0.149
computing METEOR score...
METEOR: 0.198
computing Rouge score...
ROUGE_L: 0.355
computing CIDEr score...
CIDEr: 0.286
dict_items([('Bleu_1', 0.42764553337868794), ('Bleu_2', 0.2948387302060803), ('Bleu_3', 0.20952298535641137), ('Bleu_4', 0.14879782756275167), ('METEOR', 0.19819163743106483), ('ROUGE_L', 0.3553399956876799), ('CIDEr', 0.2857728355936625)])
Epoch [12/30], Step [0/23], Loss: 5.8445, Perplexity: 345.3424
Epoch [12/30], Step [10/23], Loss: 5.6301, Perplexity: 278.7007
Epoch [12/30], Step [20/23], Loss: 6.0490, Perplexity: 423.6797
Epoch [12/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 12410, 'reflen': 10832, 'guess': [12410, 12045, 11680, 11315], 'correct': [5093, 2370, 1389, 887]}
ratio: 1.1456794682421394
Bleu_1: 0.410
Bleu_2: 0.284
Bleu_3: 0.213
Bleu_4: 0.166
computing METEOR score...
METEOR: 0.204
computing Rouge score...
ROUGE_L: 0.345
computing CIDEr score...
CIDEr: 0.706
dict_items([('Bleu_1', 0.4103948428686212), ('Bleu_2', 0.2841657409598994), ('Bleu_3', 0.21255318307840698), ('Bleu_4', 0.1656410501443222), ('METEOR', 0.2041329546838664), ('ROUGE_L', 0.3450181275917098), ('CIDEr', 0.705841836402278)])
Epoch [13/30], Step [0/23], Loss: 5.5290, Perplexity: 251.8848
Epoch [13/30], Step [10/23], Loss: 5.3416, Perplexity: 208.8391
Epoch [13/30], Step [20/23], Loss: 5.5677, Perplexity: 261.8334
Epoch [13/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 8494, 'reflen': 10832, 'guess': [8494, 8129, 7764, 7399], 'correct': [4223, 2046, 855, 243]}
ratio: 0.7841580502214933
Bleu_1: 0.378
Bleu_2: 0.269
Bleu_3: 0.182
Bleu_4: 0.111
computing METEOR score...
METEOR: 0.186
computing Rouge score...
ROUGE_L: 0.342
computing CIDEr score...
CIDEr: 0.285
dict_items([('Bleu_1', 0.37754429637404774), ('Bleu_2', 0.2686258200013014), ('Bleu_3', 0.18205882205375926), ('Bleu_4', 0.11075972789646069), ('METEOR', 0.18562235807655106), ('ROUGE_L', 0.3422500769366773), ('CIDEr', 0.2850090143078829)])
Epoch [14/30], Step [0/23], Loss: 5.6876, Perplexity: 295.1925
Epoch [14/30], Step [10/23], Loss: 5.8791, Perplexity: 357.4847
Epoch [14/30], Step [20/23], Loss: 4.5995, Perplexity: 99.4344
Epoch [14/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 4745, 'reflen': 10832, 'guess': [4745, 4380, 4015, 3650], 'correct': [3059, 1480, 734, 287]}
ratio: 0.4380539143278768
Bleu_1: 0.179
Bleu_2: 0.129
Bleu_3: 0.095
Bleu_4: 0.066
computing METEOR score...
METEOR: 0.138
computing Rouge score...
ROUGE_L: 0.332
computing CIDEr score...
CIDEr: 0.148
dict_items([('Bleu_1', 0.17873922263382694), ('Bleu_2', 0.12940231238214947), ('Bleu_3', 0.09467974139350316), ('Bleu_4', 0.06558570729885962), ('METEOR', 0.1379887953838238), ('ROUGE_L', 0.33170572535607434), ('CIDEr', 0.14794433680982877)])
Epoch [15/30], Step [0/23], Loss: 5.2144, Perplexity: 183.9004
Epoch [15/30], Step [10/23], Loss: 5.0088, Perplexity: 149.7222
Epoch [15/30], Step [20/23], Loss: 5.6204, Perplexity: 275.9880
Epoch [15/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 9673, 'reflen': 10832, 'guess': [9673, 9308, 8943, 8578], 'correct': [4613, 1676, 708, 288]}
ratio: 0.8930022156572291
Bleu_1: 0.423
Bleu_2: 0.260
Bleu_3: 0.168
Bleu_4: 0.109
computing METEOR score...
METEOR: 0.190
computing Rouge score...
ROUGE_L: 0.342
computing CIDEr score...
CIDEr: 0.273
dict_items([('Bleu_1', 0.42304439832362994), ('Bleu_2', 0.2599462970144023), ('Bleu_3', 0.1680455409670336), ('Bleu_4', 0.10903420887050234), ('METEOR', 0.18985648345168912), ('ROUGE_L', 0.34204168353278286), ('CIDEr', 0.2725089254204474)])
Epoch [16/30], Step [0/23], Loss: 5.3441, Perplexity: 209.3626
Epoch [16/30], Step [10/23], Loss: 4.7921, Perplexity: 120.5587
Epoch [16/30], Step [20/23], Loss: 5.1019, Perplexity: 164.3363
Epoch [16/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 12410, 'reflen': 10832, 'guess': [12410, 12045, 11680, 11315], 'correct': [5093, 2370, 1389, 887]}
ratio: 1.1456794682421394
Bleu_1: 0.410
Bleu_2: 0.284
Bleu_3: 0.213
Bleu_4: 0.166
computing METEOR score...
METEOR: 0.204
computing Rouge score...
ROUGE_L: 0.345
computing CIDEr score...
CIDEr: 0.706
dict_items([('Bleu_1', 0.4103948428686212), ('Bleu_2', 0.2841657409598994), ('Bleu_3', 0.21255318307840698), ('Bleu_4', 0.1656410501443222), ('METEOR', 0.2041329546838664), ('ROUGE_L', 0.3450181275917098), ('CIDEr', 0.705841836402278)])
Epoch [17/30], Step [0/23], Loss: 4.6348, Perplexity: 103.0065
Epoch [17/30], Step [10/23], Loss: 4.6893, Perplexity: 108.7732
Epoch [17/30], Step [20/23], Loss: 4.9937, Perplexity: 147.4872
Epoch [17/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 6570, 'reflen': 10832, 'guess': [6570, 6205, 5840, 5475], 'correct': [3422, 1434, 775, 339]}
ratio: 0.6065361890693679
Bleu_1: 0.272
Bleu_2: 0.181
Bleu_3: 0.132
Bleu_4: 0.093
computing METEOR score...
METEOR: 0.145
computing Rouge score...
ROUGE_L: 0.315
computing CIDEr score...
CIDEr: 0.335
dict_items([('Bleu_1', 0.27226078666480413), ('Bleu_2', 0.18135580438334914), ('Bleu_3', 0.13164592232212924), ('Bleu_4', 0.09269943074061796), ('METEOR', 0.14510754470564172), ('ROUGE_L', 0.3152601225379323), ('CIDEr', 0.33456071727565223)])
Epoch [18/30], Step [0/23], Loss: 4.5094, Perplexity: 90.8629
Epoch [18/30], Step [10/23], Loss: 3.6944, Perplexity: 40.2206
Epoch [18/30], Step [20/23], Loss: 4.8416, Perplexity: 126.6750
Epoch [18/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 10605, 'reflen': 10832, 'guess': [10605, 10240, 9875, 9510], 'correct': [5129, 2496, 1425, 756]}
ratio: 0.9790435745937057
Bleu_1: 0.473
Bleu_2: 0.336
Bleu_3: 0.252
Bleu_4: 0.188
computing METEOR score...
METEOR: 0.219
computing Rouge score...
ROUGE_L: 0.350
computing CIDEr score...
CIDEr: 0.521
dict_items([('Bleu_1', 0.4733974931879136), ('Bleu_2', 0.33607580914931345), ('Bleu_3', 0.25173990531620904), ('Bleu_4', 0.1877047876239403), ('METEOR', 0.21880184440081982), ('ROUGE_L', 0.34999488101354015), ('CIDEr', 0.5205374750212902)])
Epoch [19/30], Step [0/23], Loss: 4.4397, Perplexity: 84.7487
Epoch [19/30], Step [10/23], Loss: 5.0597, Perplexity: 157.5356
Epoch [19/30], Step [20/23], Loss: 4.2961, Perplexity: 73.4113
Epoch [19/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 12410, 'reflen': 10832, 'guess': [12410, 12045, 11680, 11315], 'correct': [5093, 2370, 1389, 887]}
ratio: 1.1456794682421394
Bleu_1: 0.410
Bleu_2: 0.284
Bleu_3: 0.213
Bleu_4: 0.166
computing METEOR score...
METEOR: 0.204
computing Rouge score...
ROUGE_L: 0.345
computing CIDEr score...
CIDEr: 0.706
dict_items([('Bleu_1', 0.4103948428686212), ('Bleu_2', 0.2841657409598994), ('Bleu_3', 0.21255318307840698), ('Bleu_4', 0.1656410501443222), ('METEOR', 0.2041329546838664), ('ROUGE_L', 0.3450181275917098), ('CIDEr', 0.705841836402278)])
Epoch [20/30], Step [0/23], Loss: 4.0449, Perplexity: 57.1042
Epoch [20/30], Step [10/23], Loss: 4.1069, Perplexity: 60.7551
Epoch [20/30], Step [20/23], Loss: 4.6516, Perplexity: 104.7558
Epoch [20/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 9855, 'reflen': 10832, 'guess': [9855, 9490, 9125, 8760], 'correct': [4556, 1830, 747, 262]}
ratio: 0.9098042836040519
Bleu_1: 0.419
Bleu_2: 0.270
Bleu_3: 0.176
Bleu_4: 0.110
computing METEOR score...
METEOR: 0.196
computing Rouge score...
ROUGE_L: 0.340
computing CIDEr score...
CIDEr: 0.270
dict_items([('Bleu_1', 0.41867036432359633), ('Bleu_2', 0.2703965309960144), ('Bleu_3', 0.17566221897447581), ('Bleu_4', 0.11007643429905516), ('METEOR', 0.19594169272310658), ('ROUGE_L', 0.33985485721183484), ('CIDEr', 0.2695861845374191)])
Epoch [21/30], Step [0/23], Loss: 4.3271, Perplexity: 75.7253
Epoch [21/30], Step [10/23], Loss: 3.4310, Perplexity: 30.9071
Epoch [21/30], Step [20/23], Loss: 3.8222, Perplexity: 45.7065
Epoch [21/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 6935, 'reflen': 10832, 'guess': [6935, 6570, 6205, 5840], 'correct': [3806, 1679, 803, 295]}
ratio: 0.6402326440176661
Bleu_1: 0.313
Bleu_2: 0.214
Bleu_3: 0.150
Bleu_4: 0.099
computing METEOR score...
METEOR: 0.151
computing Rouge score...
ROUGE_L: 0.345
computing CIDEr score...
CIDEr: 0.184
dict_items([('Bleu_1', 0.3128803240849964), ('Bleu_2', 0.213505839056404), ('Bleu_3', 0.1498245800629545), ('Bleu_4', 0.09920386155856943), ('METEOR', 0.15121600379919736), ('ROUGE_L', 0.344596799013028), ('CIDEr', 0.18375533362383015)])
Epoch [22/30], Step [0/23], Loss: 3.9732, Perplexity: 53.1560
Epoch [22/30], Step [10/23], Loss: 4.0746, Perplexity: 58.8266
Epoch [22/30], Step [20/23], Loss: 4.0559, Perplexity: 57.7381
Epoch [22/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 12021, 'reflen': 10832, 'guess': [12021, 11656, 11291, 10926], 'correct': [5016, 2359, 1394, 890]}
ratio: 1.1097673559821724
Bleu_1: 0.417
Bleu_2: 0.291
Bleu_3: 0.218
Bleu_4: 0.171
computing METEOR score...
METEOR: 0.204
computing Rouge score...
ROUGE_L: 0.348
computing CIDEr score...
CIDEr: 0.697
dict_items([('Bleu_1', 0.41726977788866004), ('Bleu_2', 0.29060137602809477), ('Bleu_3', 0.21846166185928875), ('Bleu_4', 0.17071183372584653), ('METEOR', 0.2036990638880555), ('ROUGE_L', 0.3479340443262483), ('CIDEr', 0.6966771853584977)])
Epoch [23/30], Step [0/23], Loss: 3.8872, Perplexity: 48.7762
Epoch [23/30], Step [10/23], Loss: 3.8671, Perplexity: 47.8030
Epoch [23/30], Step [20/23], Loss: 3.5235, Perplexity: 33.9019
Epoch [23/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 12045, 'reflen': 10832, 'guess': [12045, 11680, 11315, 10950], 'correct': [5044, 2394, 1375, 826]}
ratio: 1.111983013293841
Bleu_1: 0.419
Bleu_2: 0.293
Bleu_3: 0.218
Bleu_4: 0.167
computing METEOR score...
METEOR: 0.203
computing Rouge score...
ROUGE_L: 0.347
computing CIDEr score...
CIDEr: 0.676
dict_items([('Bleu_1', 0.41876297218759495), ('Bleu_2', 0.29297110454918923), ('Bleu_3', 0.218490506901534), ('Bleu_4', 0.16748114110396867), ('METEOR', 0.2033260279028781), ('ROUGE_L', 0.3469840265832118), ('CIDEr', 0.676210453151955)])
Epoch [24/30], Step [0/23], Loss: 3.2337, Perplexity: 25.3738
Epoch [24/30], Step [10/23], Loss: 3.1249, Perplexity: 22.7577
Epoch [24/30], Step [20/23], Loss: 3.5431, Perplexity: 34.5733
Epoch [24/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 12410, 'reflen': 10832, 'guess': [12410, 12045, 11680, 11315], 'correct': [5093, 2370, 1389, 887]}
ratio: 1.1456794682421394
Bleu_1: 0.410
Bleu_2: 0.284
Bleu_3: 0.213
Bleu_4: 0.166
computing METEOR score...
METEOR: 0.204
computing Rouge score...
ROUGE_L: 0.345
computing CIDEr score...
CIDEr: 0.706
dict_items([('Bleu_1', 0.4103948428686212), ('Bleu_2', 0.2841657409598994), ('Bleu_3', 0.21255318307840698), ('Bleu_4', 0.1656410501443222), ('METEOR', 0.2041329546838664), ('ROUGE_L', 0.3450181275917098), ('CIDEr', 0.705841836402278)])
Epoch [25/30], Step [0/23], Loss: 3.7177, Perplexity: 41.1685
Epoch [25/30], Step [10/23], Loss: 3.3618, Perplexity: 28.8417
Epoch [25/30], Step [20/23], Loss: 3.6503, Perplexity: 38.4880
Epoch [25/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 7300, 'reflen': 10832, 'guess': [7300, 6935, 6570, 6205], 'correct': [3562, 1465, 730, 305]}
ratio: 0.6739290989659643
Bleu_1: 0.301
Bleu_2: 0.198
Bleu_3: 0.139
Bleu_4: 0.095
computing METEOR score...
METEOR: 0.155
computing Rouge score...
ROUGE_L: 0.309
computing CIDEr score...
CIDEr: 0.230
dict_items([('Bleu_1', 0.30077651059721744), ('Bleu_2', 0.19790372503604042), ('Bleu_3', 0.138946015302027), ('Bleu_4', 0.09494941672841947), ('METEOR', 0.1553012379270906), ('ROUGE_L', 0.30856842571772813), ('CIDEr', 0.22983172239019867)])
Epoch [26/30], Step [0/23], Loss: 3.7912, Perplexity: 44.3099
Epoch [26/30], Step [10/23], Loss: 3.1299, Perplexity: 22.8714
Epoch [26/30], Step [20/23], Loss: 2.6981, Perplexity: 14.8521
Epoch [26/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 12410, 'reflen': 10832, 'guess': [12410, 12045, 11680, 11315], 'correct': [5093, 2370, 1389, 887]}
ratio: 1.1456794682421394
Bleu_1: 0.410
Bleu_2: 0.284
Bleu_3: 0.213
Bleu_4: 0.166
computing METEOR score...
METEOR: 0.204
computing Rouge score...
ROUGE_L: 0.345
computing CIDEr score...
CIDEr: 0.706
dict_items([('Bleu_1', 0.4103948428686212), ('Bleu_2', 0.2841657409598994), ('Bleu_3', 0.21255318307840698), ('Bleu_4', 0.1656410501443222), ('METEOR', 0.2041329546838664), ('ROUGE_L', 0.3450181275917098), ('CIDEr', 0.705841836402278)])
Epoch [27/30], Step [0/23], Loss: 3.5067, Perplexity: 33.3368
Epoch [27/30], Step [10/23], Loss: 3.0458, Perplexity: 21.0269
Epoch [27/30], Step [20/23], Loss: 3.2758, Perplexity: 26.4635
Epoch [27/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 11850, 'reflen': 10832, 'guess': [11850, 11485, 11120, 10755], 'correct': [5572, 2473, 1382, 715]}
ratio: 1.0939807976365312
Bleu_1: 0.470
Bleu_2: 0.318
Bleu_3: 0.233
Bleu_4: 0.170
computing METEOR score...
METEOR: 0.223
computing Rouge score...
ROUGE_L: 0.339
computing CIDEr score...
CIDEr: 0.442
dict_items([('Bleu_1', 0.4702109704640953), ('Bleu_2', 0.31819469674661), ('Bleu_3', 0.23259285882055877), ('Bleu_4', 0.17006744582972008), ('METEOR', 0.22315217463523626), ('ROUGE_L', 0.33894026501166313), ('CIDEr', 0.44237790386350045)])
Epoch [28/30], Step [0/23], Loss: 3.4810, Perplexity: 32.4907
Epoch [28/30], Step [10/23], Loss: 2.9864, Perplexity: 19.8141
Epoch [28/30], Step [20/23], Loss: 3.2056, Perplexity: 24.6702
Epoch [28/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 9490, 'reflen': 10832, 'guess': [9490, 9125, 8760, 8395], 'correct': [4312, 2025, 1154, 642]}
ratio: 0.8761078286557537
Bleu_1: 0.394
Bleu_2: 0.276
Bleu_3: 0.206
Bleu_4: 0.155
computing METEOR score...
METEOR: 0.184
computing Rouge score...
ROUGE_L: 0.347
computing CIDEr score...
CIDEr: 0.339
dict_items([('Bleu_1', 0.3944555609088338), ('Bleu_2', 0.27566897428719), ('Bleu_3', 0.20559900513693605), ('Bleu_4', 0.15498537710096236), ('METEOR', 0.18412993720050377), ('ROUGE_L', 0.3465315911968157), ('CIDEr', 0.3391619542854837)])
Epoch [29/30], Step [0/23], Loss: 3.4694, Perplexity: 32.1175
Epoch [29/30], Step [10/23], Loss: 2.6206, Perplexity: 13.7440
Epoch [29/30], Step [20/23], Loss: 3.0102, Perplexity: 20.2916
Epoch [29/30], Step [0/3]
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 12410, 'reflen': 10832, 'guess': [12410, 12045, 11680, 11315], 'correct': [5093, 2370, 1389, 887]}
ratio: 1.1456794682421394
Bleu_1: 0.410
Bleu_2: 0.284
Bleu_3: 0.213
Bleu_4: 0.166
computing METEOR score...
METEOR: 0.204
computing Rouge score...
ROUGE_L: 0.345
computing CIDEr score...
CIDEr: 0.706
dict_items([('Bleu_1', 0.4103948428686212), ('Bleu_2', 0.2841657409598994), ('Bleu_3', 0.21255318307840698), ('Bleu_4', 0.1656410501443222), ('METEOR', 0.2041329546838664), ('ROUGE_L', 0.3450181275917098), ('CIDEr', 0.705841836402278)])
